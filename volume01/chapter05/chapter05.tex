% !TEX useAlternatePath
% !TEX useConTeXtSyncParser

\startcomponent chapter05
\project project_world
\product prd_volume01

\doifmode{*product}{\setupexternalfigures[directory={chapter05/images}]}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\startchapter[title=Potential Energy, reference=ch:PotentialEnergy]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\placefigure[margin,none]{}{\small
	\startalignment[flushleft]
At this point it may be suitable to admonish – since to many anything new is suspect – that I conceived the whole Theory in my mind, wrote the treatise, communicated most of it privately among friends, even sketched some things in the presence of the Society, before I undertook any experiment,\dots at last the experiments were made before friends and they agreed with the Theory as much as I myself could barely hope.\autocite{p.4}{DBernoulli1968}
	\stopalignment
	\startalignment[flushright]
	{\it Hydrodynamics}\\
	{\sc Daniel Bernoulli}\\
	1700–1782
	\stopalignment
}

\Initial{P}{endulums, especially pendulum collisions,} provided the first clues needed to understand both momentum and kinetic energy. Galileo discovered another intriguing pendulum property, this time using the interrupted pendulum. Figure~\ref{fig:InterruptedPendulum1} shows this pendulum, which Galileo describes in \booktitle{Two New Sciences}.

%  conservation of height with a with a simple interrupted pendulum,
\startbuffer[TikZ:InterruptedPendulum1]
\environment env_physics
\environment env_TikZ
\setupbodyfont [libertinus,11pt]
\setoldstyle % Old style numerals in text
\startTEXpage\small
\starttikzpicture% tikz code
	\fill (0,3) circle[radius=.4mm]node[above left]{A}; % Pivot
	\node at (0,0) [below left]{B}; % Bottom
	\draw (0,-0.2) -- (0,3.2); % Central vertical
	\node at (-2.4,1.2) [above=1mm]{C}; % Left
	\node at (2.4,1.2) [above=1mm]{D}; % Right
	\draw (-2.54,1.2) -- (2.54,1.2); % horizontal at max height
	\draw[thick] (0,3) -- (0,0); % String
	\draw[ball color=white] (0,0) circle[radius=1mm]; % Ball
\stoptikzpicture
\stopTEXpage
\stopbuffer

\placefigure[margin][fig:InterruptedPendulum1] % Location, Label
{Galileo’s pendulum consists of a ball at B hanging from a nail at A by a thread.}	 % caption text
{\noindent\typesetbuffer[TikZ:InterruptedPendulum1]} % Redrawn, reversed Galileo diagram
% {\externalfigure[GalileoInturuptedPendulum][width=144pt]} % Original from Galileo

\startblockquote
	Imagine this page to represent a vertical wall with a nail driven into it; and from the nail let there be suspended a lead ball of about fifty grams by means of a fine vertical thread, AB, say approximately a meter long\dots.\autocite{p.~343, "one or two ounces" changed to "about fifty grams," \quotation{two or three cubits} changed to \quotation{approximately a meter.}}{Galileo1638}
\stopblockquote
The thread must hang a few centimeters in front of the wall so that the lead ball can swing freely without touching the wall.
\startbuffer[TikZ:InterruptedPendulum2]
\environment env_physics
\environment env_TikZ
\setupbodyfont [libertinus,11pt]
\setoldstyle % Old style numerals in text
\startTEXpage\small
\starttikzpicture% tikz code
	\fill (0,3) circle[radius=.4mm]node[above left]{A}; % Pivot
	\node at (0,0) [below left]{B}; % Bottom
	\draw (0,-0.2) -- (0,3.2); % Central vertical
	\node at (-2.4,1.2) [above=1mm]{C}; % Left
	\node at (2.4,1.2) [above=1mm]{D}; % Right
	\draw (-2.54,1.2) -- (2.54,1.2); % horizontal at max height
	% Pendulum path
	\draw[] (0,0) arc[start angle=270, end angle=217, radius=3cm];
	\draw[] (0,0) arc[start angle=270, end angle=323, radius=3cm];
	\draw[thick, opacity=.5] (0,3) -- (-2.4,1.2); % String
	\draw[ball color=white, opacity=.5] (-2.4,1.2) circle[radius=1mm]; % Ball
	\draw[thick] (0,3) -- (2.4,1.2); % String
	\draw[ball color=white] (2.4,1.2) circle[radius=1mm]; % Ball
\stoptikzpicture
\stopTEXpage
\stopbuffer

\placefigure[margin][fig:InterruptedPendulum2] % Location, Label
{Galileo’s pendulum always swings from C through B to D, reaching the original height.}	 % caption text
{\noindent\typesetbuffer[TikZ:InterruptedPendulum2]} % Redrawn, reversed Galileo diagram

\startblockquote
	\dots on this wall draw a horizontal line CD, at right angles to the vertical thread AB\dots. Now bring the thread AB with the attached ball into the position AC and set it free [fig.~\ref{fig:InterruptedPendulum2}]; first it will be observed to descend along the arc CBD, to pass the point B, and to travel along the arc BD, till it almost reaches the horizontal CD, a slight shortage being caused by the resistance of the air and of the string; from this we may rightly infer that the ball in its descent through the arc CB acquired an impetus on reaching B that was just sufficient to carry it through a similar arc BD to the same height.\autocite{p.~343-4 for all of the remaining Galileo quotes in this section.}{Galileo1638}
\stopblockquote
As we have seen, attempts to quantify Galileo’s impetus caused great confusion because there are \emph{two} quantities\dash momentum and kinetic energy\dash that are both important for understanding an object’s motion.
With luck, one of these will be the \quotation{impetus} acquired in the ball’s descent and sufficient for the ball’s ascent to the same height.
\startbuffer[TikZ:InterruptedPendulum3]
\environment env_physics
\environment env_TikZ
\setupbodyfont [libertinus,11pt]
\setoldstyle % Old style numerals in text
\startTEXpage\small
\starttikzpicture% tikz code
	\fill (0,3) circle[radius=.4mm]node[above left]{A}; % Pivot
	\node at (0,0) [below left]{B}; % Bottom
	\draw (0,-0.2) -- (0,3.2); % Central vertical
	\node at (-2.4,1.2) [above=1mm]{C}; % Left
	\node at (2.4,1.2) [above=1mm]{D}; % Right
	\fill (0,2) circle[radius=.4mm]node[left]{E}; % 2nd nail
	\node at (1.833,1.2) [above=1mm]{G}; % Right
	\draw (-2.54,1.2) -- (2.54,1.2); % horizontal at max height
	% Pendulum path
	\draw[] (0,0) arc[start angle=270, end angle=217, radius=3cm];
	\draw[] (0,0) arc[start angle=270, end angle=323, radius=3cm];
	\draw[] (0,0) arc[start angle=270, end angle=336.4, radius=2cm];
	\draw[thick, opacity=.5] (0,3) -- (-2.4,1.2); % String
	\draw[ball color=white, opacity=.5] (-2.4,1.2) circle[radius=1mm]; % Ball
	\draw[thick] (0,3) -- (0,2); % String
	\draw[thick] (0,2) -- (1.833,1.2); % String
	\draw[ball color=white] (1.833,1.2) circle[radius=1mm]; % Ball
\stoptikzpicture
\stopTEXpage
\stopbuffer

\placefigure[margin][fig:InterruptedPendulum3] % Location, Label
{Galileo’s interrupted pendulum always swings to the same height, even when the string hits a nail placed at E, below the pivot.}	 % caption text
{\noindent\typesetbuffer[TikZ:InterruptedPendulum3]} % Redrawn, reversed Galileo diagram
\startblockquote
	Having repeated this experiment many times, let us now drive a nail into the wall\dots say at E [fig.~\ref{fig:InterruptedPendulum3}]\dots so that it projects out some ten to fifteen centimeters in order that the thread, again carrying the ball through the arc CB, may strike upon the nail E when the ball reaches B, and thus compel it to traverse the arc BG, described about E as center. %\quotation{five or six inches} changed to \quotation{ten to fifteen centimeters.}
\stopblockquote
The nail at E interrupts the pendulum’s swing, and the ball travels up the steeper arc BG.
\startblockquote
	You will be pleased to see that the ball swings to the point G in the horizontal\dots.
\stopblockquote
Galileo noticed that G is the same height as C and D. The interruption does not make G higher by reducing the length of the ascending path, nor does it make G lower by making the path steeper. The \quotation{impetus} acquired by the pendulum during its descent from C to B is exactly enough to carry it up the shorter, steeper ascent from B to the G.
\startbuffer[TikZ:InterruptedPendulum4]
\environment env_physics
\environment env_TikZ
\setupbodyfont [libertinus,11pt]
\setoldstyle % Old style numerals in text
\startTEXpage\small
\starttikzpicture% tikz code
	\fill (0,3) circle[radius=.4mm]node[above left]{A}; % Pivot
	\node at (0,0) [below left]{B}; % Bottom
	\draw (0,-0.2) -- (0,3.2); % Central vertical
	\node at (-2.4,1.2) [above=1mm]{C}; % Left
	\node at (2.4,1.2) [above=1mm]{D}; % Right
	\fill (0,2) circle[radius=.4mm]node[left]{E}; % 2nd nail
	\fill (0,1) circle[radius=.4mm]node[left]{F}; % 3nd nail
	\node at (1.833,1.2) [above=1mm]{G}; % Right
	\node at (0.98,1.2) [above=1mm]{I}; % Right
	\draw (-2.54,1.2) -- (2.54,1.2); % horizontal at max height
	% Pendulum path
	\draw[] (0,0) arc[start angle=270, end angle=217, radius=3cm];
	\draw[] (0,0) arc[start angle=270, end angle=323, radius=3cm];
	\draw[] (0,0) arc[start angle=270, end angle=336.4, radius=2cm];
	\draw[] (0,0) arc[start angle=270, end angle=371.5, radius=1cm];
	\draw[thick, opacity=.5] (0,3) -- (-2.4,1.2); % String
	\draw[ball color=white, opacity=.5] (-2.4,1.2) circle[radius=1mm]; % Ball
	\draw[thick] (0,3) -- (0,1); % String
	\draw[thick] (0,1) -- (0.98,1.2); % String
	\draw[ball color=white] (0.98,1.2) circle[radius=1mm]; % Ball
\stoptikzpicture
\stopTEXpage
\stopbuffer

\placefigure[margin][fig:InterruptedPendulum4] % Location, Label
{Galileo’s interrupted pendulum again swings to the same height when the string hits a nail placed at F.}	 % caption text
{\noindent\typesetbuffer[TikZ:InterruptedPendulum4]} % Redrawn, reversed Galileo diagram
\startblockquote
\dots and you would see the same thing happen if the obstacle were placed at some lower point, say at F [fig.~\ref{fig:InterruptedPendulum4}], about which the ball would describe the arc BI, the rise of the ball always terminating exactly on the line CD.%\autocite{p.~344}{Galileo1638}
\stopblockquote
%Placing the nail even lower at F gives the same result. The path from B to I is even shorter and steeper, but I’s height is the same as the height of C, D, and G.
In fact, the interrupting nail does not have to be directly below the pivot at A, it can be anywhere. I find this experiment surprisingly entertaining. Galileo clearly enjoyed it as well.
\startblockquote
	But when the nail is placed so low that the remainder of the thread below it will not reach to the height CD (which would happen if the nail were placed nearer to B than to the intersection of AB with the horizontal CD), then the thread leaps over the nail and twists itself about it.
\stopblockquote
If you know a five-year-old, then you have a perfect partner for this experiment. If you do not, you have my permission to try it anyway.

Huygens, who discovered the conservation of $mv$ and $mv^2$ in pendulum collisions, also studied the colliding pendulums’ initial and final heights, and again he discovered something quite remarkable.
Pendulums of different masses may be released from various heights. Then, after colliding with each other, those masses will ascend to other various heights. Huygens discovered that for elastic collisions the total of the masses times their heights (total $mh$, where $h$ is the mass’s height) is the same before and after the collision.

Huygens then related the total $mh$ at release to the total $mv^2$ at the collision, showing that the total $mh$ lost in the masses’ descent is proportional to the $mv^2$ right before the collision. Likewise the total $mv^2$ right after the collision is proportional to the total $mh$ gained in the masses’ ascent.
%Huygens made all of the observations before Newton introduced momentum, before Leibniz introduced \visviva, and long before the concept of kinetic energy. None the less, we should take a moment to understand his observation in modern physics language.
%Huygens then took on the problem of what happens before the system returns to rest. Galileo had shown that pendulum descends the loss of height is proportional to the increase in square of the pendulum’s speed.
%Between the moments of initial and final rest the masses descend and pick up some kinetic energy, exchange that energy in the collisions, and then loose the kinetic energy as they ascend.
Huygens extended his analysis to any system moved by gravity. Whenever the system’s total $mh$ decreased, the total $mv^2$ would increase proportionally; when the total $mh$ increased, the total $mv^2$ would decrease proportionally. In Huygens’ view, a system in motion always has the potential to ascend to a greater height and come to rest. Even though the system’s actual height may be lower, this potential height is conserved. Considering Galileo’s interrupted pendulum Huygens would say that as the pendulum swings through B it has the potential to ascend to the line CD, which it does.

Johann Bernoulli, an early advocate for \visviva\, saw the situation from the opposite perspective. To him, the initial heights represented stored \visviva. When the pendulums were released, the \visviva\ could emerge during the descent only to return to the stored state during the ascent. In this view, conservation of \visviva\ must take into account the stored \visviva\ in the total $mh$ as well as the total $mv^2$ in the motion. Considering Galileo’s interrupted pendulum, Bernoulli would say that the pendulum at C contains potential \visviva, which becomes actual \visviva\ during the descent to B. This \visviva\ is then stored as potential \visviva\ during the ascent to line CD.

As a practical matter, Huygen’s view and Bernoulli’s view are interchangeable. The modern view does not prefer either form. Energy is changing from a static state to a moving state and then back. The moving state is kinetic energy. The static form of energy is called \keyterm{potential energy}.

%The relationship between Huygens’ heights and \visviva\ was already getting very complicated when 
Johann Bernoulli’s son, Daniel Bernoulli, first recognized energy's tremendous versatility. He discovered the connection between physicists' \visviva\ and engineers' work (\at{pp.}[sec:ConservationofEnergy]--\at[secend:ConservationofEnergy]). He also recognized that energy can transform between kinetic and potential forms.

D.~Bernoulli's goal was to understand the motion of fluids, a study called hydrodynamics (from the Greek {\it hudro-,} meaning \quotation{water,} and {\it dunamis,} meaning \quotation{power}). Hydrodynamics is necessary for understanding the motion of water in pipes, through pumps, out of fountains, and around moving ships. Many natural philosophers, going back to ancient times, had attempted and failed to find a useful method for understanding these interesting and practical problems.
D.~Bernoulli attacked these problems using conservation of energy, which he adopts as a starting assumption or \keyterm{hypothesis.}
%decided to solve the problem of motions and pressures in fluids. The younger Bernoulli did not attempt to demonstrate mathematically that Huygen’s relationship between total $mh$ and $mv^2$ applies to fluids (or, equivalently, that fluids obey conservation of \visviva). Instead he assumed, as a hypothesis, in order to make predictions. 
He describes this project in the introduction to his revolutionary work on fluids, \booktitle{Hydrodynamica}, published in 1738.

\startblockquote
	It is amazing how much utility this hypothesis may have in mechanical Philosophy\dots it is the same [hypothesis] that I employed for investigating in fluids the laws of motion arising from their own gravity\dots However, I preferred to adopt this hypothesis with Huygenian rather than Paternal words, and to mark it with the name of \textit{the equality between actual descent and potential ascent,} rather than by that other of \textit{conservation of vis viva,} which some even yet dislike, chiefly in England, I know not by what misfortune.\autocite{p.~12-3.}{DBernoulli1968}
\stopblockquote
The complicated systems of pipes, tanks, and fountains studied by Daniel Bernoulli were vastly more complex than the systems considered by Huygens and the elder Bernoulli, but the energy conservation law Daniel Bernoulli used to analyze these systems is quite simple. In his study of fluids, Daniel Bernoulli was the first to carefully account for the system’s kinetic and potential energy, as well as any energy added or removed through the work of outside forces. This careful application of a simple law produced an abundant harvest of detailed and often surprising predictions.
Daniel Bernoulli refers to these predictions as \quotation{theorems} because they each follow logically from the law of conservation of energy.
%\startblockquote
%	in this way much presents itself that was previously unknown, not only about the motion of water but also, as one can see, surprisingly, about its pressure which, with no Analysis yet performed, no one will have easily foreseen or expected.\autocite{p.~13.}{DBernoulli1968}
%\stopblockquote
\startblockquote
	The Theorems which are presented are not only new, but the majority are unexpected, of the truth of all of which I was not able to convince myself clearly until I had conducted experiments which removed all my doubt.\autocite{p.~10.}{DBernoulli1968}
\stopblockquote
Every experiment testing these predictions also tests the conservation law on which these predictions are based. The remarkable agreement between predictions and experiments gave Daniel Bernoulli great confidence in the law of conservation of energy.

\section[sec:GravU]{Gravitational potential energy}

The complicated systems studied by Huygens and D.~Bernoulli all store energy as \keyterm{gravitational potential energy}. Luckily, we can understand gravitational potential energy by applying D.~Bernoulli’s insights to Galileo’s simple pendulum experiments. A version of Galileo’s pendulum with a $150\units{g}$ mass is shown in figure~\in[fig:GalileoPendulum1].

\startbuffer[TikZ:GalileoPendulum1]
\environment env_physics
\environment env_TikZ
\setupbodyfont [libertinus,11pt]
\setoldstyle % Old style numerals in text
\startTEXpage\small
\starttikzpicture% tikz code
%	\draw [help lines, xstep=8, ystep=.34] (-4.3,0) grid (4.3,4.3); % Background grid
%	\draw (-4.3,-0.5) rectangle (4.3,4.5); % Border
	% h axis
	\draw[
		postaction={decorate},
		decoration={
			markings, % Main marks
			mark=between positions 0 and 1 step 1cm with {
				\draw (0,0)
				node[left]{
					\pgfmathparse{
						-10+10*\pgfkeysvalueof{%
							/pgf/decoration/mark info/sequence number%
						}
					}
					\pgfmathprintnumber{\pgfmathresult}
				} -- (0,-4pt);
			},
		}
	] (-4.3,0) -- (-4.3,4);
	\draw[
		postaction={decorate},
		decoration={
			markings, % Main marks
			mark=between positions 0 and 1 step 1mm with {
				\draw (0,0) -- (0,-2pt);
			},
		}
	] (-4.3,0) --node[sloped,above=5mm]{$h$ (cm)} (-4.3,4);
	% U axis
	\draw[
		postaction={decorate},
		decoration={
			markings, % Main marks
			mark=between positions 0 and 1 step 6.8mm with {
				\draw (0,0)
				node[right]{
					\pgfmathparse{
						0.1*(-1+\pgfkeysvalueof{%
							/pgf/decoration/mark info/sequence number%
						})
					}
					\pgfmathprintnumber{\pgfmathresult}
				} -- (0,4pt);
			},
		}
	] (4.3,0) -- (4.3,4.082);
	\draw[
		postaction={decorate},
		decoration={
			markings, % Main marks
			mark=between positions 0 and 1 step 3.4mm with {
				\draw (0,0) -- (0,2pt);
			},
		}
	] (4.3,0) --node[sloped,below=6mm]{$U$ (J)} (4.3,4.082);
	\fill (0,4) circle[radius=.4mm]node[above left]{A}; % Pivot
	\node at (0,0) [below left]{B}; % Bottom
	\draw (0,-0.2) -- (0,4.2); % Central vertical
	\node at (-3.2,1.6) [above=2mm]{C}; % Left
	\node at (3.2,1.6) [above=1mm]{D}; % Right
%	\fill (0,2) circle[radius=.4mm]node[left]{E}; % 2nd nail
%	\fill (0,1) circle[radius=.4mm]node[left]{F}; % 3nd nail
%	\node at (1.833,1.6) [above=1mm]{G}; % Right
%	\node at (0.98,1.6) [above=1mm]{I}; % Right
	\draw (-4.0,1.6) -- (4.0,1.6); % horizontal at max height
	% Pendulum path
%	\draw[] (0,0) arc[start angle=270, end angle=336.4, radius=2cm];
%	\draw[] (0,0) arc[start angle=270, end angle=371.5, radius=1cm];
	% Positive on the right
	\draw[
%		postaction={decorate},
%		decoration={
%			markings, % Main marks
%			mark=between positions 0 and 1 step 1cm with {
%				\draw (0,0) -- (0,-4pt)
%				node[below,transform shape]{
%					\pgfmathparse{
%						-10+10*\pgfkeysvalueof{%
%							/pgf/decoration/mark info/sequence number%
%						}
%					}
%					\pgfmathprintnumber{\pgfmathresult}
%				};
%			},
%		}
	] (0,0) arc[start angle=270, end angle=323.1, radius=4cm];
%	\draw[
%		postaction={decorate},
%		decoration={
%			markings, % Main marks
%			mark=between positions 0 and 1 step 0.998mm with {
%				\draw (0,0) -- (0,-2pt);
%			},
%		}
%	] (0,0) arc[start angle=270, end angle=360, radius=5cm];
	% Negative on the left
	\draw[
%		postaction={decorate},
%		decoration={
%			markings, % Main marks
%			mark=between positions 0 and 1 step 1cm with {
%				\draw (0,0) -- (0,4pt)
%				node[below,font=transform shape,rotate=180]{
%					\pgfmathparse{
%						10-10*\pgfkeysvalueof{%
%							/pgf/decoration/mark info/sequence number%
%						}
%					}
%					\pgfmathprintnumber{\pgfmathresult}
%				};
%			},
%		}
	] (0,0) arc[start angle=270, end angle=216.9, radius=4cm];
%	\draw[
%		postaction={decorate},
%		decoration={
%			markings, % Main marks
%			mark=between positions 0 and 1 step 0.998mm with {
%				\draw (0,0) -- (0,2pt);
%			},
%		}
%	] (0,0) arc[start angle=270, end angle=180, radius=5cm];
	% Pendulum
	\draw[thick] (0,4) --node[sloped,above]{$40\units{cm}$} (-3.2,1.6); % String
	\draw[ball color=white] (-3.2,1.6) circle[radius=2mm]; % Ball , opacity=.5
	\fill (-3.2,1.6) circle[radius=.4mm]; % CoM
\stoptikzpicture
\stopTEXpage
\stopbuffer

\placetextfloat[top][fig:GalileoPendulum1] % location
{A smaller version of Galileo’s pendulum. Both the heigh $h$ and the gravitational potential energy $U$ are shown for this $150\units{g}$ pendulum.}	 % caption text
{\noindent\typesetbuffer[TikZ:GalileoPendulum1]} % figure contents

To perform his experiment, Galileo brings the pendulum to position C where it has some gravitational potential energy.
The symbol for any type of potential energy is $U$. The formula for gravitational potential energy is
\startformula
	U = mgh.
\stopformula
Along with Hugyens’ $mh$, this formula includes $g$, which is the same $9.8\units{m/s^2}$ found in the formula for gravitational force, $F = mg$. The $g$ is included because Earth’s gravitational attraction makes this energy storage possible. On the moon, where $g$ is smaller, lifting an object requires less work, but it also stores less gravitational potential energy.

%\placefigure[margin][fig:GravPotentialEnergy] % location
%{Gravitational potential energy is proportional to the mass and the height.}	% caption text
%{\externalfigure[GravPotentialEnergy][width=144pt]} % File

We will measure the hight $h$ from the equilibrium point at B, as shown on the left side of figure~\in[fig:GalileoPendulum1]. At C, the ball's height is $16\units{cm}$, so its gravitational potential energy is
\startformula
	U = mgh
		= (0.150\units{kg})(9.8\units{m/s^2})(0.16\units{m})
		= 0.24\units{kg\.m^2/s^2}
		= 0.24\units{J}.
\stopformula
The final answer has energy units, as it should. The pendulum at C has $0.24\units{J}$ of gravitational potential energy.

This gravitational potential energy was stored in the ball when Galileo moved the ball from B to C, which required him to do some work on the pendulum.

\startexample[ex:GalileoPendulum1] How much work did Galileo do on the $150\units{g}$ pendulum when he moved it from its equilibrium position at B to the point C, $16\units{cm}$ higher?
\startsolution
	Following Daniel Bernoulli, we start with the law of conservation of energy. The total energy includes the ball's kinetic and potential energies. That is $H\si=K\si+U\si$ and $H\sf=K\sf+U\sf$. Galileo's work will be $W$, increasing the ball's energy.
\startformula\startmathalignment
\NC	H\si + W + \cancel{Q}	\NC = H\sf			\NR
\NC	K\si + U\si + W			\NC = K\sf + U\sf	\NR
\stopmathalignment\stopformula
	Since the pendulum starts motionless at B and ends motionless at C, the initial and final kinetic energies are both zero. The initial height of the ball at B is zero, so the initial gravitational potential energy is zero. Only the work and final gravitational potential energy remain.
\startformula\startmathalignment
\NC	\cancel{K\si} + \cancel{U\si} + W	\NC = \cancel{K\sf} + U\sf	\NR
\NC	W							\NC = 0.24\units{J}	\NR
\stopmathalignment\stopformula
	Galileo did $0.24\units{J}$ of work on the pendulum when he moved it from B to C.
\stopsolution
\stopexample

Whenever you are asked to calculate work, you should consider using the work formula $W = F_x\Delta x + F_y\Delta y + F_z\Delta z$. However, the work formula would be a poor choice here, because you do not know the force Galileo applied. Conservation of energy only requires the direct calculation of initial and final energies, which is easy.

The height $h$ can be measured from the floor, a table top, sea level, or any other convenient reference\dash as long as that reference stays in place for the entire calculation. A convenient choice is often the lowest point of the motion, like the point B along the path of Galileo’s pendulum. The pendulum’s gravitational potential energy, calculated from the ball’s height, is shown for all heights along the right side of figure~\in[fig:GalileoPendulum1]. Using a different reference point, like the floor, shifts all of the heights on the left and all of the potential energies on the right. However, this would not force Galileo to do more work. No matter where the reference point is, he moves the pendulum from B to C, increasing the height by $16\units{cm}$. This increases the potential energy by $0.24\units{J}$, so he still does $0.24\units{J}$ of work on the pendulum.

When Galileo releases the pendulum, it will swing toward B. The ball's $0.24\units{J}$ of potential energy gradually changes to kinetic energy – and the ball's speed increases.

\startexample[ex:GalileoPendulum1] Galileo releases the pendulum at point C and it swings through the equilibrium point B. What is the ball’s speed as it passes through B?
\startsolution
The descending pendulum’s gravitational potential energy will decrease during the descent, and the kinetic energy will increase by the same amount. All of this is accounted for using the law of conservation of energy, this time without any outside force doing work.
	\startformula\startmathalignment
	\NC	H\si + \cancel{W} + \cancel{Q}	\NC = H\sf		\NR
	\NC	K\si + U\si					\NC = K\sf + U\sf
	\stopmathalignment\stopformula
	The pendulum starts motionless at C, so the initial kinetic energy is zero. When the pendulum reaches B, the gravitational potential energy is zero. Only the initial potential energy and final kinetic energy remain.
	\startformula\startmathalignment
	\NC	\cancel{K\si} + U\si					\NC = K\sf + \cancel{U\sf}	\NR
	%\NC	U\si	\NC = K\sf 	\NR
	\NC	mgh	\NC = \half mv^2	\NR
	\NC	v	\NC = \sqrt{2gh}
				= \sqrt{2(9.8\units{m/s^2})(0.16\units{m})}
				= 1.8\units{m/s}
	\stopmathalignment\stopformula
The ball passes through B at $1.8\units{m/s}$.
\stopsolution
\stopexample

In any conservation problem, we are free to choose the system. With conservation of energy, we choose the objects and the types of energy included in the system. How should we choose?

In the pendulum problem above, we want to know the ball's final speed, which is related to its kinetic energy.
We must include the ball's kinetic energy in the system so we can calculate the speed.
The final kinetic energy comes from the initial potential energy.
We should include the ball's potential energy in our system as well.
%The ball's kinetic energy comes from its descent. This change in height is related to the gravitational potential energy ($U = mgh$) and to the work done on the ball by the gravitational force ($W = F_y\Delta y$). We certainly want to include at least one of these in the calculation. I recommend including the gravitational potential energy in the system, as I did above.
In the example above, I wrote the total initial and final energies as $K\si + U\si$ and $K\sf +  U\sf$ to clearly indicated that both $K$ and $U$ are included in the system.

The flow of energy from potential energy to kinetic energy occurs totally within the system we have chosen, and the total energy $H$ stays constant. The energy does not come from an external force doing work on the system, which would increase the total energy. Therefore, with our choice of system, $W=0$.

%You can choose to leave the ball's gravitational potential energy out of the system, including only kinetic energy. In that case, the energy in the system does increase as the ball speeds up. This increase is due to the gravitational force, which does positive work as it pushes the ball downward. Although I do not recommend it, this method does produce the correct answer. Here is how it is done:

%In the solution above I asserted that there is no work done by outside forces. You might object – the nail exerts a force on the string, the string exerts a force on the ball, and Earth exerts a downward for on the ball as well. Any one of these could do work!
%
%However, the nail does no work because it has no displacement. The string is attached to the ball, which does have a displacement, but the displacement is always perpendicular to the force exerted by the string, so the string also does no work. (The nail and string do contribute momentum to the ball. We would not want to solve this problem using conservation of momentum!)
%
%The most serious challenge is Earth’s gravitational force, which does do work. We did not include the work done by gravity because it is moving energy within the system – from potential energy to kinetic energy – not adding work from outside. To understand this clearly, we should carefully define our system.
%
%%or not depending on what we chose to include in our system.
%%This problem could have been solved using the work done by the gravitational force on the pendulum during the descent from C to B. The difference between my solution and the solution using work is the choice of the system being studied.
%First, the pendulum’s kinetic energy is a property of the pendulum. To study pendulum’s the motion we must include the pendulum’s kinetic energy in our system. Second, Earth is outside the system. We do not want to include Earth's kinetic energy just to understand a pendulum.
%
%The pendulum is in, Earth is out, but what about the energy coming from the gravitational attraction between the pendulum and Earth?
%The gravitational potential energy is not actually in the pendulum, nor is it in Earth. The gravitational potential energy is in the gravitational field surrounding the pendulum. We can chose to include this potential energy in our system or not. 
%
%
%If you chose to make the pendulum the only thing in the system, then the gravitational force is an outside force that does work on the system. Since the potential energy is outside the system it does not contribute to the total energy, therefore $H=K$. Using this method the solution looks like this:
%	\startformula\startmathalignment
%	\NC	H\si + W + \cancel{Q}		\NC = H\sf			\NR
%	\NC	\cancel{K\si} + F_y\Delta y	\NC = K\sf			\NR
%	\NC	(-mg)(-h)					\NC = \half mv^2	\NR
%	\NC	v						\NC = \sqrt{2gh}
%						= \sqrt{2(9.8\units{m/s^2})(0.16\units{m})}
%							= 1.8\units{m/s}
%	\stopmathalignment\stopformula
%There are some tricky signs in the middle, but the final answer is exactly the same.
%While both methods are acceptable, you should include the gravitational potential energy $U$ in the system.
%Daniel Bernoulli taught that including potential energy in the system is both easier and gives better insight.

When choosing the system, you are not on a mission to find every type of energy related to the objects in the problem, only the ones useful in solving the problem. You do not need Earth's kinetic energy or the energy of random microscopic motion in the ball. The pendulum's energy moves between gravitational potential energy and kinetic energy. These are all you need.

%If you include the gravitational potential energy in the system, as I did originally, then the gravitational force is not an external force – it is internal to the system. This force plays a roll in moving energy from one part of the system (the gravitational field) to another part (the pendulum), but it does not add any energy to the system, nor does it remove any energy from the system. That is why there was no external work in my solution.

%During the descent and assent the pendulum’s energy is split between gravitational potential energy and kinetic energy. The gradual decrease in gravitational potential energy during the descent and the increase during the assent are graphed in \in{figure}[fig:GalileoPendulumGraphU]. The energy is shown as a function of the ball’s position $s$ along the curved path, as shown in \in{figure}[fig:GalileoPendulumPath2]. The gravitational potential energy is determined by the height of each position, and can be graphed for all positions along the path. The equilibrium point is the point of lowest potential energy at $s=0\units{cm}$.

%\startbuffer[TikZ:GalileoPendulumPath1]
%\environment env_physics
%\environment env_TikZ
%\setupbodyfont [libertinus,11pt]
%\setoldstyle % Old style numerals in text
%\startTEXpage\small
%\starttikzpicture% tikz code
%	\draw [help lines, xstep=8, ystep=.34] (-4.3,0) grid (4.3,4.3); % Background grid
%%	\draw (-4.3,-0.5) rectangle (4.3,4.5); % Border
%	% h axis
%	\draw[
%		postaction={decorate},
%		decoration={
%			markings, % Main marks
%			mark=between positions 0 and 1 step 1cm with {
%				\draw (0,0)
%				node[left]{
%					\pgfmathparse{
%						-10+10*\pgfkeysvalueof{%
%							/pgf/decoration/mark info/sequence number%
%						}
%					}
%					\pgfmathprintnumber{\pgfmathresult}
%				} -- (0,-4pt);
%			},
%		}
%	] (-4.3,0) -- (-4.3,4);
%	\draw[
%		postaction={decorate},
%		decoration={
%			markings, % Main marks
%			mark=between positions 0 and 1 step 1mm with {
%				\draw (0,0) -- (0,-2pt);
%			},
%		}
%	] (-4.3,0) --node[sloped,above=5mm]{$h$ (cm)} (-4.3,4);
%	% U axis
%	\draw[
%		postaction={decorate},
%		decoration={
%			markings, % Main marks
%			mark=between positions 0 and 1 step 6.8mm with {
%				\draw (0,0)
%				node[right]{
%					\pgfmathparse{
%						0.1*(-1+\pgfkeysvalueof{%
%							/pgf/decoration/mark info/sequence number%
%						})
%					}
%					\pgfmathprintnumber{\pgfmathresult}
%				} -- (0,4pt);
%			},
%		}
%	] (4.3,0) -- (4.3,4.082);
%	\draw[
%		postaction={decorate},
%		decoration={
%			markings, % Main marks
%			mark=between positions 0 and 1 step 3.4mm with {
%				\draw (0,0) -- (0,2pt);
%			},
%		}
%	] (4.3,0) --node[sloped,below=6mm]{$U$ (J)} (4.3,4.082);
%	\fill (0,4) circle[radius=.4mm]; % Pivot
%%	\node at (0,0) [above left]{B}; % Bottom
%%	\draw (0,-0.2) -- (0,4.2); % Central vertical
%%	\node at (-3.2,1.6) [above=2mm]{C}; % Left
%%	\node at (3.2,1.6) [above=1mm]{D}; % Right
%%	\fill (0,2) circle[radius=.4mm]node[left]{E}; % 2nd nail
%%	\fill (0,1) circle[radius=.4mm]node[left]{F}; % 3nd nail
%%	\node at (1.833,1.6) [above=1mm]{G}; % Right
%%	\node at (0.98,1.6) [above=1mm]{I}; % Right
%%	\draw (-4.0,1.6) -- (4.0,1.6); % horizontal at max height
%	% Pendulum path
%%	\draw[] (0,0) arc[start angle=270, end angle=336.4, radius=2cm];
%%	\draw[] (0,0) arc[start angle=270, end angle=371.5, radius=1cm];
%	% Positive on the right
%	\draw[
%		postaction={decorate},
%		decoration={
%			markings, % Main marks
%			mark=between positions 0 and 1 step 1cm with {
%				\draw (0,0) -- (0,-4pt)
%				node[below,transform shape]{
%					\pgfmathparse{
%						-10+10*\pgfkeysvalueof{%
%							/pgf/decoration/mark info/sequence number%
%						}
%					}
%					\pgfmathprintnumber{\pgfmathresult}
%				};
%			},
%		}
%	] (0,0) arc[start angle=270, end angle=339, radius=4cm];
%	\draw[
%		postaction={decorate},
%		decoration={
%			markings, % Main marks
%			mark=between positions 0 and 1 step 0.998mm with {
%				\draw (0,0) -- (0,-2pt);
%			},
%		}
%	] (0,0) arc[start angle=270, end angle=339, radius=4cm];
%	% Negative on the left
%	\draw[
%		postaction={decorate},
%		decoration={
%			markings, % Main marks
%			mark=between positions 0 and 1 step 1cm with {
%				\draw (0,0) -- (0,4pt)
%				node[below, transform shape, rotate=180]{
%					\pgfmathparse{
%						10-10*\pgfkeysvalueof{%
%							/pgf/decoration/mark info/sequence number%
%						}
%					}
%					\pgfmathprintnumber{\pgfmathresult}
%				};
%			},
%		}
%	] (0,0) arc[start angle=270, end angle=201, radius=4cm];
%	\draw[
%		postaction={decorate},
%		decoration={
%			markings, % Main marks
%			mark=between positions 0 and 1 step 0.998mm with {
%				\draw (0,0) -- (0,2pt);
%			},
%		}
%	] (0,0) arc[start angle=270, end angle=201, radius=4cm];
%	\node at (0,0) [below=5mm]{$s$ (cm)};
%	% Pendulum
%	\draw[thick] (0,4) --node[sloped,above]{$40\units{cm}$} (0,0); % String
%	\draw[ball color=white] (0,0) circle[radius=2mm]; % Ball , opacity=.5
%	\fill (0,0) circle[radius=.4mm]; % CoM
%\stoptikzpicture
%\stopTEXpage
%\stopbuffer
%
%\placetextfloat[top][fig:GalileoPendulumPath1] % location
%{Galileo’s pendulum with the position $s$ shown along the ball’s curved path.}	 % caption text
%{\noindent\typesetbuffer[TikZ:GalileoPendulumPath1]} % figure contents


\section{Energy Graphs}
In \in{Chapter}[ch:VisViva], energy graphs showed changes in kinetic energy caused by outside forces doing work on the system (\at{p.}[fig:CartWork]).
In this chapter, energy graphs will be even more useful, clearly showing the flow of energy from potential to kinetic and back.

\startbuffer[TikZ:GalileoPendulumPath2]
\environment env_physics
\environment env_TikZ
\setupbodyfont [libertinus,11pt]
\setoldstyle % Old style numerals in text
\startTEXpage\small
\starttikzpicture% tikz code
%	\draw [help lines, xstep=8, ystep=.34] (-4.3,0) grid (4.3,4.3); % Background grid
%	\draw (-4.3,-0.5) rectangle (4.3,4.5); % Border
	% h axis
	\draw[
		postaction={decorate},
		decoration={
			markings, % Main marks
			mark=between positions 0 and 1 step 1cm with {
				\draw (0,0)
				node[left]{
					\pgfmathparse{
						-10+10*\pgfkeysvalueof{%
							/pgf/decoration/mark info/sequence number%
						}
					}
					\pgfmathprintnumber{\pgfmathresult}
				} -- (0,-4pt);
			},
		}
	] (-4.3,0) -- (-4.3,4);
	\draw[
		postaction={decorate},
		decoration={
			markings, % Main marks
			mark=between positions 0 and 1 step 1mm with {
				\draw (0,0) -- (0,-2pt);
			},
		}
	] (-4.3,0) --node[sloped,above=5mm]{$h$ (cm)} (-4.3,4);
	% U axis
	\draw[
		postaction={decorate},
		decoration={
			markings, % Main marks
			mark=between positions 0 and 1 step 6.8mm with {
				\draw (0,0)
				node[right]{
					\pgfmathparse{
						0.1*(-1+\pgfkeysvalueof{%
							/pgf/decoration/mark info/sequence number%
						})
					}
					\pgfmathprintnumber{\pgfmathresult}
				} -- (0,4pt);
			},
		}
	] (4.3,0) -- (4.3,4.082);
	\draw[
		postaction={decorate},
		decoration={
			markings, % Main marks
			mark=between positions 0 and 1 step 3.4mm with {
				\draw (0,0) -- (0,2pt);
			},
		}
	] (4.3,0) --node[sloped,below=6mm]{$U$ (J)} (4.3,4.082);
	\fill (0,4) circle[radius=.4mm]; % Pivot
%	\node at (0,0) [above left]{B}; % Bottom
%	\draw (0,-0.2) -- (0,4.2); % Central vertical
%	\node at (-3.2,1.6) [above=2mm]{C}; % Left
%	\node at (3.2,1.6) [above=1mm]{D}; % Right
%	\fill (0,2) circle[radius=.4mm]node[left]{E}; % 2nd nail
%	\fill (0,1) circle[radius=.4mm]node[left]{F}; % 3nd nail
%	\node at (1.833,1.6) [above=1mm]{G}; % Right
%	\node at (0.98,1.6) [above=1mm]{I}; % Right
%	\draw (-4.0,1.6) -- (4.0,1.6); % horizontal at max height
	% Pendulum path
%	\draw[] (0,0) arc[start angle=270, end angle=336.4, radius=2cm];
%	\draw[] (0,0) arc[start angle=270, end angle=371.5, radius=1cm];
	% Positive on the right
	\draw[
		postaction={decorate},
		decoration={
			markings, % Main marks
			mark=between positions 0 and 1 step 1cm with {
				\draw (0,0) -- (0,-4pt)
				node[below,transform shape]{
					\pgfmathparse{
						-10+10*\pgfkeysvalueof{%
							/pgf/decoration/mark info/sequence number%
						}
					}
					\pgfmathprintnumber{\pgfmathresult}
				};
			},
		}
	] (0,0) arc[start angle=270, end angle=339, radius=4cm];
	\draw[
		postaction={decorate},
		decoration={
			markings, % Main marks
			mark=between positions 0 and 1 step 0.998mm with {
				\draw (0,0) -- (0,-2pt);
			},
		}
	] (0,0) arc[start angle=270, end angle=339, radius=4cm];
	% Negative on the left
	\draw[
		postaction={decorate},
		decoration={
			markings, % Main marks
			mark=between positions 0 and 1 step 1cm with {
				\draw (0,0) -- (0,4pt)
				node[below, transform shape, rotate=180]{
					\pgfmathparse{
						10-10*\pgfkeysvalueof{%
							/pgf/decoration/mark info/sequence number%
						}
					}
					\pgfmathprintnumber{\pgfmathresult}
				};
			},
		}
	] (0,0) arc[start angle=270, end angle=201, radius=4cm];
	\draw[
		postaction={decorate},
		decoration={
			markings, % Main marks
			mark=between positions 0 and 1 step 0.998mm with {
				\draw (0,0) -- (0,2pt);
			},
		}
	] (0,0) arc[start angle=270, end angle=201, radius=4cm];
	\node at (0,0) [below=5mm]{$s$ (cm)};
	% Pendulum
	\draw[thick] (0,4) --node[sloped,above]{$40\units{cm}$} (-3.2,1.6); % String
	\draw[ball color=white] (-3.2,1.6) circle[radius=2mm]; % Ball , opacity=.5
	\fill (-3.2,1.6) circle[radius=.4mm]; % CoM
\stoptikzpicture
\stopTEXpage
\stopbuffer

\placetextfloat[top][fig:GalileoPendulumPath2] % location
{Galileo’s pendulum at the release position $s=\units{-37cm}$.}	 % caption text
{\noindent\typesetbuffer[TikZ:GalileoPendulumPath2]} % figure contents

Galileo's pendulum is shown in \in{figure}[fig:GalileoPendulumPath2], with positions $s$ labeled along the pendulum's path.
The pendulum's energy graph, \in{figure}[fig:GalileoPendulumGraphU], shows the ball's gravitational potential energy $U$ as a function of the ball's position $s$.
The ball's gravitational potential energy depends only on the ball's position, not on its speed or momentum. This allows us to graph the gravitational potential energy $U$ for all positions before we know anything about the motion. Knowing the $U$'s graph first is important, because we will use this graph to predict the pendulum's motion.

\startbuffer[TikZ:GalileoPendulumGraphU]
\environment env_physics
\environment env_TikZ
\setupbodyfont [libertinus,11pt]
\setoldstyle % Old style numerals in text
\startTEXpage\small
\starttikzpicture% tikz code
	\startaxis[
		every tick/.style={darkgray}, % Fixes ticks which are too light in ConTeXt
		major grid style = {darkgray},
			scale only axis,
			x={1mm},y={68mm},
			xmin=-48, xmax=48,
			minor x tick num=1,
			xlabel=$s$ (cm),
			%axis x line=none,
			%axis y line*=right,
			ymin=0, ymax=0.6,
			minor y tick num=3,
			ylabel=Energy (J),
			%grid=both
		]
		\addplot[thick, domain=-50:50] {0.588*(1-cos(deg(x/40)))}node[above right,pos=.1]{$U$};
		%\addplot[thick, domain=0:75] {0.2205*(1-cos(deg(x/15))};
%		\draw[thin](-37,0) --node[pos=.7, below, sloped]{Release Position} (-37,.7);
%		\addplot[thick, red, domain=-37:37] {0.235}node[above, pos=.3]{$H$};
%		\addplot[thick, red, domain=-37:37] {0.235-0.588*(1-cos(deg(x/40))}node[below right, pos=.6]{$K$};
%		\addplot[thick, red, domain=0:23] {0.22-0.2205*(1-cos(deg(x/15))};
%	\draw[red, thin](37,0) --node[pos=.7, above, sloped]{Turning Point} (37,.7);
	\stopaxis
\stoptikzpicture
\stopTEXpage
\stopbuffer

\placetextfloat[bottom][fig:GalileoPendulumGraphU] % location
{An energy graph showing the ball’s gravitational potential energy as a function of position $s$ along the curved path.}	% caption text
{\noindent\typesetbuffer[TikZ:GalileoPendulumGraphU]} % figure contents

Galileo began his experiment by moving the pendulum from the equilibrium position at $s=0\units{cm}$ to the position $s=-37\units{cm}$ (where $h=16\units{cm}$), as shown in \in{figure}[fig:GalileoPendulumPath2].
The gravitational potential energy at this release position is $U=0.24\units{J}$, as shown on the graph in \in{figure}[fig:GalileoPendulumGraphHK].
At the moment of release, the pendulum’s kinetic energy is $K=0\units{J}$, so its total energy is $H = U + K = 0.24\units{J} + 0\units{J} = 0.24\units{J}$, which is also shown on the energy graph in \in{figure}[fig:GalileoPendulumGraphHK].

\startbuffer[TikZ:GalileoPendulumGraphHK]
\environment env_physics
\environment env_TikZ
\setupbodyfont [libertinus,11pt]
\setoldstyle % Old style numerals in text
\startTEXpage\small
\starttikzpicture% tikz code
	\startaxis[
	every tick/.style={darkgray}, % Fixes ticks which are too light in ConTeXt
	major grid style = {lightgray},
			scale only axis,
			x={1mm},y={68mm},
			xmin=-48, xmax=48,
			minor x tick num=1,
			xlabel=$s$ (cm),
			%axis x line=none,
			%axis y line*=right,
			ymin=0, ymax=0.6,
			minor y tick num=3,
			ylabel=Energy (J),
			%grid=both
		]
		\addplot[thick, domain=-50:50] {0.588*(1-cos(deg(x/40))}node[below left=-1pt, pos=.1]{$U$};
		%\addplot[thick, domain=0:75] {0.2205*(1-cos(deg(x/15))};
		\draw[thin](-37,0) --node[pos=.62, above=-2pt, sloped]{release position}node[pos=.62, below, sloped]{\& turning point} (-37,.7);
%	\ifprintanswers
		\addplot[thick, domain=-37:37] {0.235}node[above, pos=.25]{$H=U+K$};
		\addplot[thick, domain=-37:37] {0.235-0.588*(1-cos(deg(x/40)))}node[below right=-1pt, pos=.25]{$K$};
%		\addplot[thick, red, domain=0:23] {0.22-0.2205*(1-cos(deg(x/15))};
	\draw[thin](37,0) --node[pos=.62, above=-2pt, sloped]{turning point} (37,.7);
%	\fi
	\stopaxis
\stoptikzpicture
\stopTEXpage
\stopbuffer

\placetextfloat[bottom][fig:GalileoPendulumGraphHK] % location
{The energy graph for Galileo’s experiment where he releases the pendulum at $s=-37\units{cm}$.}	% caption text
{\noindent\typesetbuffer[TikZ:GalileoPendulumGraphHK]} % figure contents

Once the pendulum is released, it starts moving to the right.
Its gravitational potential energy $U$ decreases, and its kinetic energy $K$ increases. The increasing kinetic energy is shown by the curve labeled \quotation{$K$} on the graph in figure~\in[fig:GalileoPendulumGraphHK].
Since no work is done on the system by outside forces, the total energy $H=0.24\units{J}$ stays constant, as shown by the horizontal line labeled \quotation{$H$} on the graph in figure~\in[fig:GalileoPendulumGraphHK]. As the potential energy decreases, the kinetic energy increases by exactly the same amount, so that the total energy $H=U+K$ stays constant.

When the pendulum reaches the equilibrium point $s=0\units{cm}$, the potential energy is completely gone. All of the energy is kinetic, as can be seen by the point where the graph of $K$ touches the line $H$ on the graph.

As the pendulum continues upward, the potential energy increases and the kinetic energy decreases. When the pendulum reaches the position $s=37\units{cm}$, all energy is again gravitational potential energy, where the $H$ line touches the graph of $U$ in figure~\in[fig:GalileoPendulumGraphHK]. The pendulum does not have enough energy to go any further. The kinetic energy cannot be negative, so the gravitational potential energy cannot be greater than $H$. The point where the $H=U$ is called a \keyterm{turning point,} because the pendulum's motion turns at that point to go in the opposite direction, back toward lower potential energy.

As the pendulum swings back from right to left, the gravitational energy again decreases while the kinetic energy increases, until it returns to the equilibrium point. Then the gravitational potential energy increases and the kinetic energy decreases until it reaches the original release point, which is another turning point.

The pendulum will continue swinging back and forth between the turning points and $s=-37\units{s}$ and $s=37\units{cm}$. The energies will continue to follow the curves in figure~\in[fig:GalileoPendulumGraphHK], going right and then left between the turning points.

The pendulum's energy graph in \in{figure}[fig:GalileoPendulumGraphHK] allows us to see the pendulum's changing potential and kinetic energies, so we can locate the turning points and find the pendulum's speed at any position. In the actual pendulum, these energies are invisible, but energy is completely responsible for the motion. Seeing the invisible energies – with the help of energy graphs – has proven to be physicists' superpower. Once we see the pendulum's energy, we can predict everything about its motion.

For a pendulum, this prediction is not especially interesting: pendulums swing back and forth. However, seeing the energy allows us to completely predict the motion of any system, no matter how complicated. In the remainder of this chapter, we will identify more types of potential energy and use energy graphs to uncover details about vibrations and equilibrium. In \in{Chapter}[ch:Hamilton], we will learn to generate any system's complete equations of motion from the system's energy, allowing us to predict the motions of complicated systems. Then, we will solve the quadrivium puzzles of astronomy and music. (Recall how the four quadrivium paths became one, \at{p.}[NewAstronomy].)
In \in{Chapter}[ch:Rotation], we will use energy graphs to explain Kepler's new astronomy, in which the planets speed up and slow down as they follow elliptical orbits around the Sun. In \in{Chapter}[ch:Waves], we will use our knowledge of equilibrium and small vibrations to understand sound and the vibrations of musical instruments – especially the mysterious compound vibrations of a string, first noted by Mersenne, that allow a single string to produce a small chorus of pitches simultaneously. This will lead to a modern explanation for the ancient Pythagorean model of musical consonance.

This path will not be easy, but our destination is in sight. The quadrivium puzzles are linked by motion. Motion is driven by energy.

% Energy graphs like figure~\in[fig:GalileoPendulumGraphHK] are extremely useful for understanding motion. They are especially useful for finding turning points and finding speeds at specific locations, something that is often difficult to do with momentum conservation. Energy graphs are not as useful for questions involving time, since everything is graphed as a function of position. (Position vs.\ time graphs and conservation of momentum are better tools for questions involving time.)

%In the next section we will introduce two other types of potential energy. You will have the opportunity to work with graphs of these in the problem sets.

%During the descent from C to B the ball’s initial $0.24\units{J}$ of gravitational potential energy is converted to kinetic energy. Then, during the ascent the $0.24\units{J}$ of kinetic energy is converted back to gravitational potential energy, just enough to bring the ball back to its original height at D. In this experiment Galileo’s \quotation{impetus} is clearly the ball’s kinetic energy which increases during the descent from C to B and which is sufficient to carry the ball up the ascent from B to D.
%
%The gravitational field’s ability to store potential energy was a great mystery until Einstein explained that it has to do with the bending of space-time. This is extremely interesting and terribly complicated. Luckily, Daniel Bernoulli showed us how to deal with these sorts of mind-boggling complications: ignore them.
%[ Why fluids in this next sentence? Remind reader of Hydrodynamica. ]
%He did not need to know the details of intermolecular forces in fluids, and you do not need to know the details of space-time bending. Just use the potential energy formula and everything will be fine, provided you are careful to include the potential energy in the system and remember that the gravitational force is an internal force that does no work \emph{on the system.}

%Gravitational potential energy was the first form of potential energy to be identified and quantified, but there are other ways to store energy


\section{Ideal springs and simple harmonic motion}

Simple harmonic motion, first introduced in \in{Chapter}[ch:Motion] (\at{p.}[sec:SHO]), is produced by a simple system consisting of a mass connected to an ideal spring, as shown in \in{figure}[fig:SpringCart]. The spring has a natural length ($18\units{cm}$ in the figure), so it holds the cart gently in place at the equilibrium position $x=0\units{cm}$. The cart can be moved to the left, compressing the spring, or moved to the right, stretching the string. 
The spring's \keyterm{stiffness}\pagereference[kt:stiffness], represented by $k$, is a measure of how difficult it is to stretch or compress the spring. Very stiff springs are hard to stretch or compress, while springs with a small stiffness stretch or compress easily. (The spring stiffness is often called the \keyterm{spring constant.})
\startbuffer[SpringCart]
	\fill [black!10] (-.23,0) rectangle (4.8,-.15);
	\fill [black!10] (0,0) rectangle (-.23,.6);
	\draw[thin] (0,0) -- (0,.6);
	\startaxis[margin cart track,
			xmin=-24,xmax=24,
			ymax=10,
			]
	\path (0,0) pic {cart};%node[above = 5mm]{$m$};
	\draw[decorate,decoration={coil,segment length=3.6pt}] (-24,2.5) --node[above=3pt] {$k$} (-6,2.5);
    \stopaxis
\stopbuffer

\marginTikZ{}{SpringCart}{A cart connected to an ideal spring. This spring's natural length is $18\units{cm}$, so it holds the cart gently at $x=0\units{cm}$.} % vskip, name, caption

\startbuffer[SpringCartRight]
	\fill [black!10] (-.23,0) rectangle (4.8,-.15);
	\fill [black!10] (0,0) rectangle (-.23,.6);
	\draw[thin] (0,0) -- (0,.6);
	\startaxis[margin cart track,
			xmin=-24,xmax=24,
			ymax=10,
			]
	\path (12,0) pic {cart};
	\draw[decorate,decoration={coil,segment length=6.1pt}] (-24,2.5) -- (6,2.5);
    \stopaxis
\stopbuffer

\marginTikZ{}{SpringCartRight}{The cart is moved to the right, stretching the spring.} % vskip, name, caption
Moving the cart away from equilibrium, as shown in \in{figure}[fig:SpringCartRight], requires some work. This work stores potential energy in the spring. 
Ideal springs have a simple potential energy formula.
\startformula[eq:1DUspring]
	U = \half kx^2
\stopformula

\startuseMPgraphic{graph::IdealSpringU} % I'd like to add minor ticks, 0.667mm long.
	path U, H, K, TPL, TPR;
	U := (-24,24) ..controls (-8,-8) and (8,-8).. (24,24);
	H := (-12,6) -- (12,6);
	K := (-24,-18) ..controls (-8,14) and (8,14).. (24,-18);
	TPL := (-12,0) -- (-12,24);
	TPR := (12,0) -- (12,24);
draw begingraph(4.5cm,2.4cm);
	setrange(-21,0, 24, 24);
	itick.lft(formatted("$@g$", 0), 0);
	for x=auto.x:
		itick.bot(formatted("$@g$", x), x);
		itick.bot(formatted("@s", ""), x) withcolor "middlegray";
		itick.top(formatted("@s", ""), x) withcolor "middlegray";
	endfor
	glabel.lft(textext("Energy") rotated 90,OUT)  shifted (2mm,0);
	glabel.bot(textext("$x$ (cm)"), OUT);
	gdraw(U) withpen pencircle scaled 0.8pt;
	glabel.urt("$U$",0.2);
%	gdraw(H) withpen pencircle scaled 0.8pt;
%	glabel.top("$H$",0.15);
%	gdraw(K) withpen pencircle scaled 0.8pt;
%	glabel.lrt("$K$",0.4);
%	gdraw(TPL) withpen pencircle scaled 0.8pt withcolor "middlegray";
%	glabel.top("Turning",0.7) rotatedaround(point 0.7 of TPL, 90);
%	glabel.bot("point",0.7) rotatedaround(point 0.7 of TPL, 90);
%	gdraw(TPR) withpen pencircle scaled 0.8pt withcolor "middlegray";
%	glabel.top("Turning",0.7) rotatedaround(point 0.7 of TPR, 90);
%	glabel.bot("point",0.7) rotatedaround(point 0.7 of TPR, 90);
endgraph;
\stopuseMPgraphic

\startplacefigure[location=margin, reference=fig:IdealSpringU, title={The potential energy of an ideal spring is a perfect parabola.}]
\small
\reuseMPgraphic{graph::IdealSpringU}
\stopplacefigure
\noindent
The ideal spring's energy graph, shown in \in{figure}[fig:IdealSpringU], looks almost identical to the pendulum's graph in \in{figure}[fig:GalileoPendulumGraphU], and the motion is also similar.

\startbuffer[SpringCartLeft]
	\fill [black!10] (-.23,0) rectangle (4.8,-.15);
	\fill [black!10] (0,0) rectangle (-.23,.6);
	\draw[thin] (0,0) -- (0,.6);
	\startaxis[margin cart track,
			xmin=-24,xmax=24,
			ymax=10,
			]
	\path (-12,0) pic {cart};
	\draw[decorate,decoration={coil,segment length=1.06pt}] (-24,2.5) -- (-18,2.5);
    \stopaxis
\stopbuffer

\marginTikZ{}{SpringCartLeft}{A cart connected to an ideal spring will oscillate with simple harmonic motion.} % vskip, name, caption

For example, pushing the cart to the left, as shown in \in{figure}[fig:SpringCartLeft] stores some potential energy in the spring, as shown in the energy graph in \in{figure}[fig:CartGraphEnergy].
When the cart is released, the spring will push the cart back toward the equilibrium point at $x=0\units{cm}$, and the spring’s potential energy will get converted to kinetic energy of the cart.
As the cart passes through the equilibrium, all of the energy is kinetic.  Then the cart will slow as its kinetic energy is again turned into spring potential energy, this time in the stretched spring.
The cart will continue to oscillate back-and-forth between the turning points. The system's energy will continue changing from the spring's potential energy to the cart's kinetic energy and then changing back with each trip from one turning point to the other.
\startuseMPgraphic{graph::CartGraphEnergy} % I'd like to add minor ticks, 0.667mm long.
	path U, H, K, TPL, TPR;
	U := (-24,24) ..controls (-8,-8) and (8,-8).. (24,24);
	H := (-12,6) -- (12,6);
	K := (-24,-18) ..controls (-8,14) and (8,14).. (24,-18);
	TPL := (-12,0) -- (-12,24);
	TPR := (12,0) -- (12,24);
draw begingraph(4.5cm,2.4cm);
	setrange(-21,0, 24, 24);
	itick.lft(formatted("$@g$", 0), 0);
	for x=auto.x:
		itick.bot(formatted("$@g$", x), x);
		itick.bot(formatted("@s", ""), x) withcolor "middlegray";
		itick.top(formatted("@s", ""), x) withcolor "middlegray";
	endfor
	glabel.lft(textext("Energy") rotated 90,OUT)  shifted (2mm,0);
	glabel.bot(textext("$x$ (cm)"), OUT);
	gdraw(TPL) withcolor "middlegray";
	glabel.top("turning",0.72) rotatedaround(point 0.72 of TPL, 90);
	glabel.bot("point",0.72) rotatedaround(point 0.72 of TPL, 90);
	gdraw(TPR) withcolor "middlegray";
	glabel.top("turning",0.72) rotatedaround(point 0.72 of TPR, 90);
	glabel.bot("point",0.72) rotatedaround(point 0.72 of TPR, 90);
	gdraw(U) withpen pencircle scaled 0.8pt;
	glabel.llft("$U$",0.2);
	gdraw(H) withpen pencircle scaled 0.8pt;
	glabel.urt("$H=U+K$",0.07);
	gdraw(K) withpen pencircle scaled 0.8pt;
	glabel.lrt("$K$",0.4);
endgraph;
\stopuseMPgraphic

\startplacefigure[location=margin, reference=fig:CartGraphEnergy, title={The energy graph for a cart released at $x=-12\units{cm}$. The cart will oscillate between the turning points.}]
\small
\reuseMPgraphic{graph::CartGraphEnergy}
\stopplacefigure

In the last section I promised that any system's motion could be predicted using energy. For the cart connected to an ideal spring, the motion is simple harmonic. All we need to determine is the motion's amplitude $A$ and period $T$. (I have not proven to you that this system's motion is simple harmonic. You will have to trust me for now.)

The motion's amplitude is the maximum displacement from the equilibrium point. This is easy to find on the energy graph – it is the distance to the turning points, which are determined by the initial energy. The amplitude $A$ of the cart's simple harmonic motion is shown on the position vs.\ time graph in \in{figure}[fig:CartGraphs].
(I have rotated the position vs.\ time graph $90°$ clockwise to align the position axis with the position axis of the energy graph above it. 
You may want to rotate the page for a minute so you can recognize the time and position axes.)
You can see how the cart's release point, the turning points, and the amplitude line up. In the diagram, the cart is released at $x=-12\units{cm}$, so the turning points are at $x=\pm12\units{cm}$. The position vs.\ time graph shows the cart's motion oscillating between $x=-12\units{cm}$ and $x=12\units{cm}$. Therefore, the amplitude of the oscillations is $A=12\units{cm}$.

\startbuffer[SpringCartClean]
	\fill [black!10] (-.23,0) rectangle (4.8,-.15);
	\fill [black!10] (0,0) rectangle (-.23,.6);
	\draw[thin] (0,0) -- (0,.6);
	\startaxis[margin cart track,
			xmin=-24,xmax=24,
			ymax=10,
			xlabel={},
			]
	\path (-12,0) pic {cart}node[above = 5mm]{$m$};
	\draw[decorate,decoration={coil,segment length=1.06pt}] (-24,2.5) --node[above=3pt] {$k$} (-18,2.5);
    \stopaxis
\stopbuffer

\startuseMPgraphic{graph::SHOGraphs} % I'd like to add minor ticks, 0.667mm long.
	path U, H, K, TPL, TPR;
	U := (-24,24) ..controls (-8,-8) and (8,-8).. (24,24);
	H := (-12,6) -- (12,6);
	K := (-24,-18) ..controls (-8,14) and (8,14).. (24,-18);
	TPL := (-12,0) -- (-12,24);
	TPR := (12,0) -- (12,24);
draw begingraph(4.5cm,2.4cm);
	setrange(-21,0, 24, 24);
	itick.lft(formatted("$@g$", 0), 0);
	for x=auto.x:
		itick.bot(formatted("$@g$", x), x);
		itick.bot(formatted("@s", ""), x) withcolor "middlegray";
		itick.top(formatted("@s", ""), x) withcolor "middlegray";
	endfor
	glabel.lft(textext("Energy") rotated 90,OUT)  shifted (2mm,0);
	glabel.bot(textext("$x$ (cm)"), OUT);
	gdraw(TPL) withcolor "middlegray";
	glabel.top("turning",0.72) rotatedaround(point 0.72 of TPL, 90);
	glabel.bot("point",0.72) rotatedaround(point 0.72 of TPL, 90);
	gdraw(TPR) withcolor "middlegray";
	glabel.top("turning",0.72) rotatedaround(point 0.72 of TPR, 90);
	glabel.bot("point",0.72) rotatedaround(point 0.72 of TPR, 90);
	gdraw(U) withpen pencircle scaled 0.8pt;
	glabel.llft("$U$",0.2);
	gdraw(H) withpen pencircle scaled 0.8pt;
	glabel.urt("$H=U+K$",0.07);
	gdraw(K) withpen pencircle scaled 0.8pt;
	glabel.lrt("$K$",0.4);
endgraph;
%	path p;
%	p := (8,0) ..controls (8,0.66) and (7.33,1.33).. (6,2)
%		-- (1,4.5) ..controls (0.33,4.83) and (0,5.17).. (0,5.5);
%	picture myarrow;
%	myarrow := image(
%		drawarrow (-2mm,0) -- origin withpen pencircle scaled 0.8pt;
%	);
	vardef position =
		path p;
		for t = 0 upto 160:
			x := -12*cos(t/8); augment.p(x,t); endfor;
		p enddef;
	path xmax, xmin, equlib ;
	xmax := (-12,0) -- (-12,160);
	xmin := (12,0) -- (12,160);
	equlib := (0,6) -- (0,160);
draw begingraph(4.5cm,10cm);
	setcoords(linear, -linear);
	setrange(-21,0, 24,160);
%	for y=auto.y:
	itick.lft(formatted("$@g$", 0), 0);
%		itick.lft(formatted("$@g$", y), y);
%		itick.lft(formatted("@s", ""), y) withcolor "middlegray";
%		itick.rt(formatted("@s", ""), y) withcolor "middlegray";
%	endfor
	for x=auto.x:
		%itick.top(formatted("$@g$", x), x);
		itick.bot(formatted("@s", ""), x) withcolor "middlegray";
		itick.top(formatted("@s", ""), x) withcolor "middlegray";
	endfor
	glabel.lft(textext("$t$") ,OUT) shifted (2mm,0);
	%glabel.top(textext("$x$ (m)"), OUT);
	gdraw(xmin) withcolor "middlegray";
	%glabel.top("turning",0.72);% rotatedaround(point 0.72 of TPL, 90);
	%glabel.bot("point",0.72) rotatedaround(point 0.72 of TPL, 90);
	gdraw(xmax) withcolor "middlegray";
	%glabel.top("turning",0.72) rotatedaround(point 0.72 of TPR, 90);
	%glabel.bot("point",0.72) rotatedaround(point 0.72 of TPR, 90);
	gdraw(equlib) withcolor "middlegray";
	gdrawdblarrow (0,8*3.14) -- (12,8*3.14);
	glabel.top("$A$",0.4) ;
	gdraw (12,8*3.14) -- (16,8*3.14) withcolor "middlegray";
	gdraw (12,24*3.14) -- (16,24*3.14) withcolor "middlegray";
	gdrawdblarrow (15,8*3.14) -- (15,24*3.14);
	glabel.rt("$T$",0.5) ;
	gdraw(position) withpen pencircle scaled 0.8pt;
endgraph shifted (0cm, -10.4cm);
\stopuseMPgraphic

\startplacefigure[location=margin, reference=fig:CartGraphs, title={The cart at its release position (top), the energy graph for the cart and spring (middle), and the cart's position vs.\ time graph (bottom).}]
\typesetbuffer[starttikz,SpringCartClean,stoptikz]\small
\reuseMPgraphic{graph::SHOGraphs}
\stopplacefigure

The motion's period is the time it takes the cart to go from one turning point to the other and back. This is not easy to find on the energy graph, but we can get it with a little work. We know from \in{Chapter}[ch:Motion] that the period $T$ is related to the amplitude $A$ and the maximum speed by the formula $v\sub{max} = 2\pi A/T$. (See \at{p.}[eq:vmaxT].) This can be solved for the period. 
\startformula
	T = \frac{2\pi A}{v\sub{max}}
\stopformula
We already have the amplitude $A$, all we need is the maximum speed $v\sub{max}$, which we can find using conservation of energy!
\startformula
	H\si + W + \cancel{Q}  = H\sf
\stopformula
We will start at the moment when the cart is released, and stop when the cart reaches its maximum speed at the equilibrium point. No external forces do work on this system during this time.
\startformula\startmathalignment
\NC	H\si + \cancel{W}	\NC = H\sf					\NR
\NC	K\si + U\si			\NC = K\sf + U\sf		\NR
\stopmathalignment\stopformula
When the cart is released, it does not have any kinetic energy. All of the energy is potential energy in the spring. When the cart passes through the equilibrium point, the spring's potential energy is zero, and all of the energy is in the cart's kinetic energy. 
\startformula\startmathalignment
\NC	\cancel{K\si} + U\si	\NC = K\sf + \cancel{U\sf}		\NR
\NC	\half k x\si^2		\NC = \half mv\sf^2	\NR
\stopmathalignment\stopformula
The initial position is $x\si = -A$, which we know. The final speed is the maximum speed that we need, $v\sf = v\sub{max}$. Put these into our conservation of energy equation and solve for $v\sub{max}$.
\startformula\startmathalignment
\NC	 \half k (-A)^2	\NC = \half mv\sub{max}^2	\NR
\NC	 v\sub{max}		\NC = A\sqrt{k/m}
\stopmathalignment\stopformula
To find a numerical value for $v\sub{max}$ we would need to know the spring's stiffness $k$ and the cart's mass $m$. We will leave them as variables for now. Plug this formula for $v\sub{max}$ into the formula for the period $T$, and something surprising happens.
\startformula
	T = \frac{2\pi \cancel{A}}{\cancel{A}\sqrt{k/m}} = 2\pi\sqrt{\frac{m}{k}}
\stopformula
The amplitude $A$ cancels out, meaning that the period $T$ is independent of the amplitude. If the oscillations are small, the speed is also small and each cycle takes time $T$.
If the oscillations are large the speed is also large and each cycle is still completed in the same time $T$.
Small oscillations take just as long as large oscillations! (Maybe this is not too surprising, since you have known this fact about pendulums since \in{Chapter}[ch:Motion].) The period does depend on the mass and spring stiffness. A larger mass increases the period. A stiffer spring (larger $k$) shortens the period.

We can find the oscillation's frequency as well.
\startformula
	f = \frac{1\units{cyc}}{T} = \frac{1\units{cyc}}{2\pi}\sqrt{\frac{k}{m}}
\stopformula
Again, the frequency does not depend on the amplitude, only on the mass and the spring stiffness. A stiffer spring increases the frequency. A larger mass reduces the frequency.

Whenever we encounter a mass on a spring, we could use these formulas to find the period or frequency from the spring stiffness and the mass. However, the method is important, not the formulas. Amplitude is determined by the turning points. Period is given by the equation for simple harmonic motion: $T= 2\pi A/v\sub{max}$. The maximum speed can be found using conservation of energy.
This three-step method will give the amplitude and period for simple harmonic oscillators that look nothing like a mass on a spring.

\section{Small oscillations in real systems}
We looked at the simple harmonic oscillator in some detail because simple harmonic oscillators are everywhere! All musical instruments have parts that act as a simple harmonic oscillators (the strings, for example). Many budding musicians have found that pots and pans also act as simple harmonic oscillators when struck with a wooden spoon. The human voice comes from oscillators in our throat. Even sound itself is a sort of simple harmonic oscillator in the air. Daniel Bernoulli studied simple harmonic oscillators that he made with fluid filled tubes.

Many simple harmonic oscillators are too fast or too slow for us to notice. Atoms vibrate in molecules with frequencies around $10^{12}\units{Hz}$. Oscillations in the electromagnetic field, which we perceive as light, are similarly rapid. The solar system oscillates up and down through the plane of our galaxy with a period of almost $200$ million years. Other cosmic oscillations repeat even more slowly. Simple harmonic motion is incredibly common at every scale.

\startbuffer[SpringCartBang]
	\fill [black!10] (-.23,0) rectangle (4.8,-.15);
	\fill [black!10] (0,0) rectangle (-.23,.6);
	\draw[thin] (0,0) -- (0,.6);
	\startaxis[margin cart track,
			xmin=-24,xmax=24,
			ymax=10,
			]
	\path (-15,0) pic {cart};
	\draw[decorate,decoration={coil,segment length=0.45pt}] (-24,2.5) -- (-21,2.5);
	\node[above right, rotate = 10] at (-23, 4) {Bang!};
    \stopaxis
\stopbuffer

\marginTikZ{}{SpringCartBang}{Compress a real spring too much, and its coils will collide.} % vskip, name, caption

\startbuffer[SpringCartSnap]
	\fill [black!10] (-.23,0) rectangle (4.8,-.15);
	\fill [black!10] (0,0) rectangle (-.23,.6);
	\draw[thin] (0,0) -- (0,.6);
	\startaxis[margin cart track,
			xmin=-24,xmax=24,
			ymax=10,
			]
	\path (15,0) pic {cart};
	\draw[decorate,decoration={coil,segment length=5.5pt}] (-10,2.5) -- (-24,2.5);
	\draw[decorate,decoration={coil,segment length=5.5pt}] (-5,2.5) -- (9,2.5);
	\node[above right, rotate = 10] at (-9.5, 2) {Snap!};
	\node[rotate = 10] at (-7.5, 2.5) {$\bigstar$};
    \stopaxis
\stopbuffer

\marginTikZ{}{SpringCartSnap}{Stretch a real spring too much, and it will break.} % vskip, name, caption

\startuseMPgraphic{graph::RealSpringGraphEnergy} % I'd like to add minor ticks, 0.667mm long.
	path U, H, K, TPL, TPR;
	U := (-16,24) -- (-15,75/8) ..controls (-5,-25/8) and (5,-25/8).. (15,75/8) -- (16,0);
	H := (-12,6) -- (12,6);
	K := (-24,-18) ..controls (-8,14) and (8,14).. (24,-18);
	TPL := (-12,0) -- (-12,24);
	TPR := (12,0) -- (12,24);
draw begingraph(4.5cm,2.4cm);
	setrange(-21,0, 24, 24);
	itick.lft(formatted("$@g$", 0), 0);
	for x=auto.x:
		itick.bot(formatted("$@g$", x), x);
		itick.bot(formatted("@s", ""), x) withcolor "middlegray";
		itick.top(formatted("@s", ""), x) withcolor "middlegray";
	endfor
	glabel.lft(textext("Energy") rotated 90,OUT)  shifted (2mm,0);
	glabel.bot(textext("$x$ (cm)"), OUT);
%	gdraw(TPL) withcolor "middlegray";
%	glabel.top("turning",0.72) rotatedaround(point 0.72 of TPL, 90);
%	glabel.bot("point",0.72) rotatedaround(point 0.72 of TPL, 90);
%	gdraw(TPR) withcolor "middlegray";
%	glabel.top("turning",0.72) rotatedaround(point 0.72 of TPR, 90);
%	glabel.bot("point",0.72) rotatedaround(point 0.72 of TPR, 90);
	gdraw(U) withpen pencircle scaled 0.8pt;
	glabel.llft("$U$",1.1);
	glabel.rt("Bang!",0.5) rotatedaround(point 0.5 of U, 10);
	glabel.urt("Snap!",2) rotatedaround(point 2 of U, 10);
%	gdraw(H) withpen pencircle scaled 0.8pt;
%	glabel.top("$H$",0.15);
%	gdraw(K) withpen pencircle scaled 0.8pt;
%	glabel.lrt("$K$",0.4);
endgraph;
\stopuseMPgraphic

\startplacefigure[location=margin, reference=fig:RealSpringGraphEnergy, title={The energy graph for a real spring is not a perfect parabola.}]
\small
\reuseMPgraphic{graph::RealSpringGraphEnergy}
\stopplacefigure

All of these simple harmonic oscillators only produce simple harmonic motion when the amplitude is not too big. The potential energy for a real spring, for example, is not a perfect parabola. If the spring is compressed too much, the coils collide (\in{fig.}[fig:SpringCartBang]). Compressing the spring any more would require tremendous energy. If the spring is stretched too much, it will break (\in{fig.}[fig:SpringCartSnap]), and all of the potential energy will be lost. As a result, a real spring's potential energy looks more like \in{figure}[fig:RealSpringGraphEnergy]. The middle of the potential energy graph still looks like a parabola, so the motion will be simple harmonic if the turning points are within that region. If the total energy $H$ is too high, the spring will become too compressed or stretched, and the motion will not be simple harmonic. These sorts of failures are possible with any simple harmonic oscillator. A pendulum can knock against a wall. Musical strings can snap. Molecules can break. Every simple harmonic oscillator has its limits.

Simple harmonic oscillators are everywhere, because the central parabola shape in \in{figure}[fig:RealSpringGraphEnergy] is almost universal. If an object is held in place gently, the parabola is wide (like the pendulum's in \in{figure}[fig:GalileoPendulumGraphU]), and not much energy is required to displace the object. If the object is held tightly, then the parabola is narrow, and the potential energy rises steeply on both sides of equilibrium. The system will produce simple harmonic motion in any case. \in{Figures}[fig:I2] and \in[fig:I2Energy] show another example, the potential energy function responsible for holding two iodine atoms together to form an iodine molecule, \chemical{I_2}. These two atoms act like they are held together by a spring and will vibrate with simple harmonic motion if given a small amount of energy. (Too much energy will break the molecule apart.) Most molecules have bonds that behave like springs. Larger objects have even more parts, so they contain even more ways to vibrate. Many of those vibrations are simple harmonic, even when we cannot see or hear the vibrations.

\startuseMPgraphic{I2}
draw curly (-1cm,0) -- (1cm,0) withpen pencircle scaled 0.8pt;
draw ball shifted (-1.5cm,0);
label("I",(-1.5cm,0));
draw ball shifted (1.5cm,0);
label("I",(1.5cm,0));
\stopuseMPgraphic

\startplacefigure[location=margin, reference=fig:I2, title={Two iodine atoms are connected to form an iodine molecule, \chemical{I_2}. They are actually connected by an electron bond, but they oscillate as if they are connected by a tiny spring.}]
\small
\reuseMPgraphic{I2}
\stopplacefigure

\startluacode
	function mp.morse(r)
		local U = 2.47*(1-math.exp(1.85*(2.66-r)))^2
		mp.inject.numeric(U)
	end
	function mp.morseinverselow(U)
		local r = 2.66 - math.log(1+math.sqrt(U/2.47))/1.85
		mp.inject.numeric(r)
	end
	function mp.morseinversehigh(U)
		local r = 2.66 - math.log(1-math.sqrt(U/2.47))/1.85
		mp.inject.numeric(r)
	end
\stopluacode

\startuseMPgraphic{graph::I2Energy} % I'd like to add minor ticks, 0.667mm long.
vardef U =
	path p;
		for x = 2 step 0.01 until 10:
			y := lua.mp.morse(x);
			augment.p(x,y);
		endfor;
	p enddef;
%	path U, H, K, TPL, TPR;
	path H;
	E := 0.7;
%	U := (-24,24) ..controls (-8,-8) and (8,-8).. (24,24);
	H := (lua.mp.morseinverselow(E),E) -- (lua.mp.morseinversehigh(E),E);
%	K := (-24,-18) ..controls (-8,14) and (8,14).. (24,-18);
%	TPL := (-12,0) -- (-12,24);
%	TPR := (12,0) -- (12,24);
draw begingraph(4cm,5cm);
	setrange(origin, 8, 3);
	for y=auto.y:
		itick.lft(formatted("$@g$", y), y);
		itick.lft(formatted("@s", ""), y) withcolor "middlegray";
		itick.rt(formatted("@s", ""), y) withcolor "middlegray";
	endfor
	for x=auto.x:
		itick.bot(formatted("$@g$", x), x);
		itick.bot(formatted("@s", ""), x) withcolor "middlegray";
		itick.top(formatted("@s", ""), x) withcolor "middlegray";
	endfor
	glabel.lft(textext("Energy ($\sci{-19}\units{J}$)") rotated 90,OUT);
	glabel.bot(textext("$r$ ($\sci{-10}\units{m}$)"), OUT);
%	gdraw(TPL) withcolor "middlegray";
%	glabel.top("turning",0.72) rotatedaround(point 0.72 of TPL, 90);
%	glabel.bot("point",0.72) rotatedaround(point 0.72 of TPL, 90);
%	gdraw(TPR) withcolor "middlegray";
%	glabel.top("turning",0.72) rotatedaround(point 0.72 of TPR, 90);
%	glabel.bot("point",0.72) rotatedaround(point 0.72 of TPR, 90);
	gdraw(U) withpen pencircle scaled 0.8pt;
	glabel.lft("$U$",34);
	glabel.rt("simple",104);
	glabel.rt("harmonic",95);
	glabel.rt("motion",85);
	glabel.rt("Bang!",28) rotatedaround(point 28 of U, 10);
	glabel.urt("Bye!",430) rotatedaround(point 430 of U, 10);
	gdraw(H) withpen pencircle scaled 0.8pt;
	glabel.top("$H$",0.5);
%	gdraw(K) withpen pencircle scaled 0.8pt;
%	glabel.lrt("$K$",0.4);
endgraph;
\stopuseMPgraphic

\startplacefigure[location=margin, reference=fig:I2Energy, title={Enegy graph for an iodine molecule, \chemical{I_2}, showing the potential energy as a function of the distance $r$ between the two iodine atoms. When the total energy $H$ is low, as shown, the molecule is a good simple harmonic oscillator. At higher energies the molecule can break apart.}]
\small\reuseMPgraphic{graph::I2Energy}
\stopplacefigure

%Pendulums and musical instruments are nearly ideal when their oscillations are small. In fact, most systems that oscillate or vibrate behave like simple harmonic oscillators for small amplitudes. We will look at the small oscillations of real objects in the next section. Here we look the motion of an ideal oscillator.

\startexample[ex:GalileoPendulumT] Recall Galileo's experiment with the $40\units{cm}$ long pendulum earlier in this chapter (starting on \at{p.}[sec:GravU]). Galileo pulls the pendulum to the position $s=-37\units{cm}$ along its path and releases it.
What is the pendulum's period?
\startsolution
We know the pendulum will swing between the release position at $s=-37\units{cm}$ and the other turning point at $s=37\units{cm}$. The amplitude is therefore $A=37\units{cm}$. In \in{example}[ex:GalileoPendulumT] we used conservation of energy to find the ball's maximum velocity $v\sub{max} = 1.8\units{m/s}$. All that remains is to use the period formula for simple harmonic motion.
\startformula
	T = \frac{2\pi A}{v\sub{max}} = \frac{2\pi (37\units{cm})}{1.8\units{m/s}} = 1.3\unit{s}
\stopformula
The pendulum's period is $1.3\units{s}$.
\stopsolution
\stopexample
While the pendulum is a very good simple harmonic oscillator, it is not perfect. Were you to repeat Galileo's experiment with great care, you would find that the period for small amplitudes is about one-twentieth of a second shorter than the period for $A=37\units{cm}$. This happens because the pendulum's potential energy in \in{figure}[fig:GalileoPendulumGraphU] is not a perfect parabola, it is actually a cosine function. Since it is almost a parabola, the period is only few percent longer at large amplitudes. This does not cause problems for our pendulum collision experiments, but it would be a serious problem for a pendulum clock, which is expected to keep accurate time as its pendulum swings through thousands of cycles. Good pendulum clocks use a long pendulum and a small amplitude to minimize this error. When the pendulum swings through a small angle it keeps very accurate time.

\section{Gravitational potential energy in the Solar System}

In the year that \booktitle{Hydrodynamica} was published, 1738, Daniel Bernoulli wrote a paper on the motion of the Moon. Gravitational forces in the solar system had already been studied in some detail using Newton’s methods of momentum and force.
The Moon's motion is difficult to study using Newton's methods,  because it is pulled by both Earth and the Sun. Daniel Bernoulli attacked the problem using potential and kinetic energy, and made significant progress. In this section, we will solve some easier problems using D.~Bernoulli's method.

The gravitational potential energy formula earlier in this chapter, $U=mgh$, is only useful for relatively small heights near the Earth’s surface. Over the long distances between planets, moons, and the sun, the gravitational potential energy is a bit more complicated. The gravitational potential energy of any two objects is
\startformula
	U = -G\frac{mM}{r},
\stopformula
where $m$ and $M$ are the objects’ masses, $r$ is the distance between the objects’ centers, and $G=6.67\sci{-11}\units{m^3/kg\.s^2}$ is the universal gravitational constant.

This formula is a bit intimidating, but extremely valuable if used correctly. First, notice that the distance between the objects is in the denominator. If the distance is extremely large, then their gravitational potential energy is extremely small. This is quite convenient because it means that very distant objects can be ignored. When studying the interaction of the Earth and Moon, it is not necessary to include the gravitational potential energy due to distant stars.

The second thing to notice is that the distance is between the objects’ centers. When calculating the gravitational potential energy of an object on the Earth’s surface the distance $r$ is Earth’s radius ($r\sEarth=6.37\sci{6}\units{m}$) not the height above Earth’s surface.

Third, the formula always gives a negative potential energy. This has alarmed many people, including great physicists, but it is not a problem. The gravitational potential energy is zero when the objects are far apart and it goes down as objects get closer together. Down from zero is negative. Kinetic energy is always positive, but there is no reason to be alarmed by negative potential energy.

Finally, the universal gravitational constant $G$ is extremely small, so the gravitational potential energy between every-day objects can be completely ignored. At least one of the objects must have a huge mass in order for the gravitational potential energy to be significant. Earth’s mass of $5.97\sci{24}\units{kg}$ is enough to have a significant effect.

\startexample[ex:BoxEarthGravU] How much work is required to lift a $3.0\units{kg}$ box from Earth’s surface to a location very far from Earth?

\startuseMPgraphic{graph::BoxEarthGravU} % I'd like to add minor ticks, 0.667mm long.
vardef U =
	path p;
		for x = 5 step 0.1 until 40:
			y := -11.90/x; % lua.mp.morse(x);
			augment.p(x,y);
		endfor;
	p enddef;
draw begingraph(4cm,4cm);
	setrange(0,-2, 40, 0);
	for x=auto.x:
		itick.bot(formatted("$@g$", x), x);
		itick.bot(formatted("@s", ""), x) withcolor "middlegray";
		itick.top(formatted("@s", ""), x) withcolor "middlegray";
	endfor
	glabel.lft(textext("Energy ($\sci{8}\units{J}$)") rotated 90,OUT);
	glabel.bot(textext("$r$ ($\sci{6}\units{m}$)"), OUT);
	gdraw(U) withpen pencircle scaled 0.8pt;
	glabel.lrt("$U$",140);
	gfill(unitsquare xyscaled (6.37,-2)) withcolor "lightgray";
	gdraw((6.37,0) -- (6.37,-2)) withpen pencircle scaled 0.8pt;
	for y=0 step -0.5 until -2:%auto.y:
		itick.lft(formatted("$@g$", y), y);
		itick.lft(formatted("@s", ""), y) withcolor "middlegray";
		itick.rt(formatted("@s", ""), y) withcolor "middlegray";
	endfor
endgraph shifted (0,-5cm);
  pickup pencircle scaled 0.8pt ;
  draw externalfigure "EarthEratosthenes.png" scaled 0.127 shifted (-6.37mm,-6.37mm) ;
  draw fullcircle scaled 12.74mm;
  drawarrow (0mm,0) -- (40mm,0);
    label.top  ("$r$", (20mm,0)) ;
\stopuseMPgraphic

\startplacefigure[location=margin, reference=fig:BoxEarthGravU, title={The potential energy of a $3.0\units{kg}$ object in Earth’s vicinity. The potential energy is not shown for locations inside Earth (the gray region).}]
\small\reuseMPgraphic{graph::BoxEarthGravU}
\stopplacefigure

\startsolution
	This problem is just like the earlier example where Galileo lifted the pendulum (\in{ex.}[ex:GalileoPendulum1]), but now we must use the gravitational potential energy formula that works for large distances. The gravitational potential energy for the box and Earth are plotted in figure~\ref{fig:BoxEarthGravU}.
	\startformula\startmathalignment
	\NC	H\si + W + \cancel{Q}	\NC = H\sf			\NR
	\NC	K\si + U\si + W			\NC = K\sf + U\sf
	\stopmathalignment\stopformula
	Since the box starts motionless on Earth and ends motionless far away, the initial and final kinetic energies are both zero. The final gravitational potential energy is also zero, because the box is very far from Earth. Only the work and initial potential energy remain. The initial distance between the box’s center and Earth’s center is Earth’s radius.
	\startformula\startmathalignment
	\NC	U\si + W			\NC = 0										\NR
	\NC	-G\frac{mM}{r} + W	\NC = 0										\NR
	\NC	W				\NC = G\frac{mM}{r}								\NR
	\NC					\NC = (6.67\sci{-11}\units{m^3/kg\.s^2})
				\frac{(3.0\units{kg})(5.97\sci{24}\units{kg})}{6.37\sci{6}\units{m}}		\NR
	\NC					\NC = 1.88\sci{8}\units{J}
	\stopmathalignment\stopformula
	Moving the $3\units{kg}$ box from Earth’s surface to a distant location requires a tremendous amount of work!
\stopsolution
\stopexample

The energy graph in \in{figure}[fig:BoxEarthGravU] shows the box's tremendous increase in gravitational potential energy as it is moved far from Earth. It starts at Earth's surface, with a potential energy $U=-1.88\sci{8}\units{J}$. To move the box far away requires going off the graph, far to the right in \in{figure}[fig:BoxEarthGravU], to the where $U\approx 0\units{J}$. Objects sent to deep space require giant rockets which do the work required to reach the much higher gravitational potential energy. The deep negative potential energy near Earth is often called Earth's \keyterm{gravity well.} The rocket does the work required to climb out of this deep well.

\startexample[ex:BoxEarthGravU2] The $3.0\units{kg}$ box was placed far from Earth, but even so it eventually is pulled back by Earth’s gravitational attraction. How fast is the box going when it enters the atmosphere, approximately $100\units{km}$ above Earth’s surface?
\startsolution
	Include the gravitational potential energy so that there is no work done on the system.

	\startformula\startmathalignment
	\NC	H\si + \cancel{W} + \cancel{Q}	\NC = H\sf		\NR
	\NC	K\si + U\si					\NC = K\sf + U\sf
	\stopmathalignment\stopformula
		The falling box starts with neither kinetic nor potential energy, so the initial total energy is zero. As the box falls its potential energy becomes more negative and its kinetic energy becomes more positive so that the total is unchanged at zero.
	\startformula\startmathalignment
	\NC	0				\NC = \half mv^2	- G\frac{mM}{r}	\NR
	\NC	\half \cancel{m}v^2	\NC = G\frac{\cancel{m}M}{r}		\NR
	\NC	v				\NC = \sqrt{\frac{2GM}{r}}
	\stopmathalignment\stopformula
The final distance between Earth’s center and the box is Earth’s radius plus $100\units{km}$.
	\startformula\startmathalignment
	\NC	v	\NC = \sqrt{\frac{2(6.67\sci{-11}\units{m^3/kg\.s^2})(5.97\sci{24}\units{kg})}
				{6.37\sci{6}\units{m}+1.00\sci{5}\units{m}}}		\NR
	\NC		\NC = 1.11\sci{4}\units{m/s}
	\stopmathalignment\stopformula
The box enters the atmosphere with a speed of about $11\units{km/s}$, causing it to burn up before hitting the ground.
\stopsolution
\stopexample

Daniel Bernoulli’s method – linking kinetic energy, work, and potential energy – has continued to provide insight into every known physical process, from particle interactions to the expansion of the universe. In the centuries since the publication of \booktitle{Hydrodynamica} much of the important progress in physics has come from properly identifying and quantifying the many forms of energy.

\subject{Notes}
\placenotes[endnote][criterium=chapter]

\subject{Bibliography}
  \placelistofpublications  [criterium=chapter, method=local] % Citations for this chapter


\stopchapter
\stopcomponent

%[Example problem: Make a plot of the gravitational potential around a $10\units{kg}$ bowling ball. Make the plot from the surface of the bowling ball at $r=0.10\units{m}$ to a distance $r = 1\units{m}$ from the center of the of the ball.]
%\placefigure[margin][] % location
%{}	% caption text
%\hspace{-7pt}
%%{\starttikzpicture
%%\datavisualization [scientific axes, x axis={attribute=r,
%%label={[node style={inner sep=0pt,outer sep=0pt, below = 1mm}]$r$ (m)}, include value=0, length=3.9cm},
%%y axis={attribute=Phi, label={[node style={inner sep=0pt,outer sep=0pt}] $\Phi$ ($\sci{-9}\unit{m^2/s^2}$)}, include value=0,include value=-8, ticks={step=2}},  visualize as smooth line]
%%data [format=function] {
%%    var r : interval [.11:1];
%%    func Phi = -0.667/\value r;
%%}
%%info {
%%\fill [gray] (visualization cs: r=0, Phi=-8) rectangle (visualization cs: r=.11, Phi=0);
%%};
%%\stoptikzpicture}
%{\starttikzpicture
%\startaxis
% [footnotesize, width=2.13in, height=2in,
%   xlabel={$r$ (m)},
%   xmin=0, xmax=1,
%   ylabel={$\Phi$ ($\sci{-9}\unit{m^2/s^2}$)},
%   ymin=-8, ymax=0,
%   ytick={-8,-6,...,0},
% ]
% \addplot[
%   thick,
%   domain=.11:1,
%   samples=201
%  ]
%  {-0.667/x}
%  ;
%\startpgfonlayer{background}
%\fill [black!20] (0, -8) rectangle (.11, 0);
%\stoppgfonlayer
%\stopaxis
%\stoptikzpicture}
%\caption[Gravitational potential of a ball]{
%The gravitational potential in the vicinity of a $10\units{kg}$ bowling ball. The potential is extremely small, and can only be detected with the most sensitive instruments. The potential is not shown inside the bowling ball (the gray region).
%}
%\label{fig:BallGravPot}
%%



%The gravitational potential energy is always negative. There is no reason to be alarmed by this. It is negative because gravity is attractive, so the gravitational potential energy must decrease as objects approach each other. Since the potential energy is close to zero at large distances, the potential energy can only go down by going negative as the objects approach each other. Kinetic energy is always positive, as is the energy stored in a spring, but gravitational potential energy is negative.


%\subsection{Gravitational potential energy}
%
%
%
%\subsection{Freefall}
%\label{sec:freefall}
%
%Let’s see what each of these can tell us about the motion of the cart, starting with conservation of energy. In this case we will consider the cart’s kinetic energy, $K$, and gravitational potential energy, $U$.
%\startformula\startmathalignment[m=2,distance=2em]
%	H\sf \NC = H\si + \cancel{W} + \cancel{Q}	\NC \NC \text{no outside work or heat}\NR
%	K\sf + \cancel{U\sf} \NC = K\si + U\si		\NC \NC \text{set $U=0$ at the ground}\NR
%	\half mv\sf^2 \NC = \half mv\si^2 + mgy\si	\NC \NC \text{formulae for $K$ and $U$}\NR
%	\half v\sf^2 \NC = \half v\si^2 + gh		\NC \NC \text{divide both sides by $m$}\NR
%	v\sf^2 \NC = v\si^2 + 2gh					\NC \NC \text{multiply both sides by 2}\NR
%	v\sf \NC = \pm\sqrt{v\si^2 + 2gh}			\NC \NC \text{square root of both sides}
%\stopmathalignment\stopformula
%When taking the square root of in the last line, we must include a plus-or-minus. The mathematics cannot tell us which sign to pick, but often the correct sign is obvious from the problem. For example, if an object is falling to the ground, then the final velocity in negative, so replace the $\pm$ with a negative sign.
%
%
%The downward force is the object’s weight. Objects with a small mass, like a gnat, have a small weight. Objects with a large mass also have a large weight.
%
%In fact, an object’s weight, $F\sub{G}$ is proportional to the object’s mass, $m$, and it is always downward. On Earth the force vector is
%
%The words \quotation{mass} and \quotation{weight} are often treated as synonyms, but to a physicist they are different. %They
%
%Take a moment to see that the equation fits with what you've experienced about gravitational force.  Weight is proportional to mass, meaning that the force pulling down on two identical boxes is double the force pulling down on only one.
%
%
%\subsection{Incline}

%\section{Motion with a constant force}
%
%For the programming I do not want to find average velocity. We start with a half time step to estimate the average momentum during the time step.
%
%We use that momentum to find the velocity and that velocity to update the position.
%Then we use a full time step to update the momentum and repeat the cycle.
%\placefigure[margin][] % location
%{}	% caption text
%	\marginfig{PavgConstF}
%	\caption{When the force is constant, the velocity at $t_\frac{1}{2}$ is the average velocity. This makes it easy to update the position.}
%
%
%\subsection{Momentum vs. time graphs}
%
%\begin{align}
%	x_1 \NC = x_0 + v\sub{avg} \Delta t \NR
%		\NC  =  x_0 + v\sub{avg} \Delta t
%\end{align}


% Templates:

% Margin image
\placefigure[margin][] % Location, Label
{} % Caption
{\externalfigure[chapter03/][width=144pt]} % File

% Margin Figure
\placefigure[margin][] % location
{}	% caption text
{\starttikzpicture	% tikz code
\stoptikzpicture}

% Aligned equation
\startformula\startmathalignment
\stopmathalignment\stopformula

% Aligned Equations
\startformula\startmathalignment[m=2,distance=2em]
\stopmathalignment\stopformula
