% !TEX useOldSyncParser
\startcomponent c_chapter01
\project project_world
\product prd_volume01

\setupsynctex[state=start,method=max] % "method=max" or "min"
\starttext


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\startchapter[title=Derivatives, reference=ch:Derivatives]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%If students could learn these, it might help a great deal when we try to do $\partial U/\partial x$ and $\partial H/\partial p$ in chapters 5 and 6. 

%\section{Instantaneous rate of change is a derivative}
Instantaneous velocity is defined in terms of a small change in position over a small change in time
\startformula
	v = \frac{dx}{dt}
\stopformula
This is the slope on the position vs.\ time graph, and it can be found at a specific moment by drawing a tangent line. The tangent line method is nice, but it would be great if we could find the instantaneous velocity for every moment – without having to draw a million tangent lines. This can be done with the \keyterm{derivative}.

The derivative takes one function and produces a second function that is everywhere equal to the first function's slope. For example, if the first function is an object's position as a function of time, then that function's derivative is the object's velocity as a function of time. In mathematical language, the object's position $x$ is a function of time and that function's derivative is written $\frac{d}{dt}x$. This derivative is the instantaneous velocity $v$.
\startformula
v = \ddt x
\stopformula
This formula looks very similar to the instantaneous velocity definition above. However, the definition above was a ratio of two small numbers find the instantaneous velocity at a specific moment. The derivative $\ddt$ takes the function $x$ and gives a new function $v$. The examples below will show how the derivative $\ddt$ acts on the function to its right and replaces it with a new function.

You will be able to perform all of the derivatives you need with just four rules.
First, the derivative of  a constant function (like $x = 3\units{m}$) is \emph{zero} because the rate of change is zero. This is the \keyterm{constant rule}.
\startuseMPgraphic{graph::xconst} % I'd like to add minor ticks, 0.667mm long.
	path xpos;
	xpos := (0,3) -- (4.4,3);
draw begingraph(4.4cm,4cm);
	setrange(origin, 4.4, 4);
	for y=0, 1, 2, 3, 4 :
		itick.lft(formatted("$@g$", y), y);
		itick.lft(formatted("@s", ""), y) withcolor "middlegray";
		itick.rt(formatted("@s", ""), y) withcolor "middlegray";
	endfor
	for x=auto.x:
		itick.bot(formatted("$@g$", x), x);
		itick.bot(formatted("@s", ""), x) withcolor "middlegray";
		itick.top(formatted("@s", ""), x) withcolor "middlegray";
	endfor
	glabel.lft(textext("$x$ (m)") rotated 90, OUT);
	glabel.bot(textext("$t$"), OUT);
	gdraw(xpos) withpen pencircle scaled 0.8pt;
	glabel.top("$x=3\units{m}$",0.5);
	glabel.bot("$v=0$",0.5);
endgraph;
\stopuseMPgraphic
\startplacefigure[location=margin, reference=fig:xconst, title={The function $x=3\units{m}$ is a constant. The velocity $v=\ddt x$ is zero at all times.}]
\small\reuseMPgraphic{graph::xconst}
\stopplacefigure
\startformula
	\ddt \text{const.} = 0
\stopformula
For example, the function $x=3\units{m}$ is shown in \in{figure}[fig:xconst]. The velocity $v$ is the slope, given by the derivative, which is zero.

The next rule gives the derivative of functions that are powers of $t$, like $t^2$, $t^{-1}$, or $t^1 = t$. The derivatives of these powers are given by the \keyterm{power rule}. 
\startformula
	\ddt t^n = nt^{n-1}
\stopformula

For a function that is a sloped straight line, like $x = t$, the derivative is the line's slope. (We are ignoring units \emph{briefly}.)
The slope is the same at all times, so the derivative is the same at all times, as in \in{figure}[fig:xlin]. This slope is given by the power rule with $n=1$. 
\startuseMPgraphic{graph::xlin} % I'd like to add minor ticks, 0.667mm long.
	path xpos;
	xpos := (0,0) -- (5,5);
draw begingraph(4.4cm,4.4cm);
	setrange(origin, 4.4, 4.4);
	for y=auto.y:
		itick.lft(formatted("$@g$", y), y);
		itick.lft(formatted("@s", ""), y) withcolor "middlegray";
		itick.rt(formatted("@s", ""), y) withcolor "middlegray";
	endfor
	for x=auto.x:
		itick.bot(formatted("$@g$", x), x);
		itick.bot(formatted("@s", ""), x) withcolor "middlegray";
		itick.top(formatted("@s", ""), x) withcolor "middlegray";
	endfor
	glabel.lft(textext("$x$"),OUT);
	glabel.bot(textext("$t$"), OUT);
	gdraw(xpos) withpen pencircle scaled 0.8pt;
	gdotlabel.ulft("$x=1$" , 0.2);
	glabel.bot("$v=1$" , 0.2) rotatedaround(point 0.2 of xpos, 45);
	gdotlabel.ulft("$x=2$" , 0.4);
	glabel.bot("$v=1$" , 0.4) rotatedaround(point 0.4 of xpos, 45);
	gdotlabel.ulft("$x=3$" , 0.6);
	glabel.bot("$v=1$" , 0.6) rotatedaround(point 0.6 of xpos, 45);
	gdotlabel.ulft("$x=4$" , 0.8);
	glabel.bot("$v=1$" , 0.78) rotatedaround(point 0.78 of xpos, 45);
endgraph;
\stopuseMPgraphic
\startplacefigure[location=margin, reference=fig:xlin, title={The function $x=t$ is a straight line. The velocity $v=\ddt x$ is $1$ at all times.}]
\small\reuseMPgraphic{graph::xlin}
\stopplacefigure
\startformula
	\ddt t = \ddt t^1 = 1t^{1-1} = 1t^0 = 1
\stopformula
For a parabola, like $x = t^2$, the slope is different at different locations, so the derivative is a new function. \in{Figure}[fig:xquad] shows the function $x=t^2$ and some slopes, which can be found using the power rule with $n=2$.
\startuseMPgraphic{graph::xquad} % I'd like to add minor ticks, 0.667mm long.
	path xpos;
	xpos := (-3,9) ..controls (-1,-3) and (1,-3).. (3,9);
draw begingraph(4.6cm,4.8cm);
	setrange(-2.3, -0.4, 2.3, 4.4);
	for y=auto.y:
		itick.lft(formatted("$@g$", y), y);
		itick.lft(formatted("@s", ""), y) withcolor "middlegray";
		itick.rt(formatted("@s", ""), y) withcolor "middlegray";
	endfor
	for x=auto.x:
		itick.bot(formatted("$@g$", x), x);
		itick.bot(formatted("@s", ""), x) withcolor "middlegray";
		itick.top(formatted("@s", ""), x) withcolor "middlegray";
	endfor
	glabel.lft(textext("$x$"),OUT);
	glabel.bot(textext("$t$"), OUT);
	gdraw(xpos) withpen pencircle scaled 0.8pt;
	gdotlabel.rt("$x=4$" , 1/6);
	glabel.lrt("$v=-4$" , 1/6) rotatedaround(point 1/6 of xpos, -76);
	gdotlabel.urt("$x=1$" , 1/3);
	glabel.bot("$v=-2$" , 1/3) rotatedaround(point 1/3 of xpos, -63.4);
	gdotlabel.top("" , 0.5) ;
	glabel.top("$x=0$" , 0.5) shifted (0, 0.1);
	glabel.bot("$v=0$" , 0.5) shifted (0, 0.05);
	gdotlabel.ulft("$x=1$" , 2/3);
	glabel.bot("$v=2$" , 2/3) rotatedaround(point 2/3 of xpos, 63.4);
	gdotlabel.lft("$x=4$" , 5/6);
	glabel.llft("$v=4$" , 5/6) rotatedaround(point 5/6 of xpos, 76);
endgraph;
\stopuseMPgraphic
\startplacefigure[location=margin, reference=fig:xquad, title={The function $x=t^2$ is not straight. The velocity $v=\ddt x = 2t$ changes with time.}]
\small\reuseMPgraphic{graph::xquad}
\stopplacefigure
\startformula
	\ddt t^2 = 2t^{2-1} = 2t^1 = 2t
\stopformula
The power rule works for any power, including negative powers (like $x = 1/t = t^{-1}$) and fractional powers (like $x = \sqrt{t} = t^{\onehalf}$).

\startexample[ex:DerivativeConstantV]
Find $\ddt t^3$.
\startsolution
Use the power rule with $n=3$.
\startformula
	\ddt t^3 = 3 t^{3-1} = 3t^2
\stopformula
\stopsolution
\stopexample
\startexample[ex:DerivativeConstantV]
Find $\ddt \sqrt{t}$.
\startsolution
Use the power rule with $n=\onehalf$.
\startformula
	\ddt \sqrt{t} = \ddt t^\onehalf = \onehalf\,t^{\onehalf-1} = \onehalf\,t^{-\onehalf} = \frac{1}{2\sqrt{t}}
\stopformula
\stopsolution
\stopexample

The third rule says that when a function is multiplied by some constant, its slope is multiplied by the same constant. This constant multiplier is called a \emph{coefficient}. For any function of time $f$ muliplied by a coefficient $a$ we use the \keyterm{coefficient rule}.
\startformula
	\ddt af  = a \ddt f
\stopformula
On the left, the derivative is acting on $af$. On the right the derivative is only acting on $f$. We often say that we have pulled the constant $a$ out of the derivative.
The coefficient $a$ will typically have units. (Yay, units!) For example, if an object's momentum is given by the formula $p = (14\units{kg\.m/s^3})\,t^2$, we can find the force, which is the derivative of momentum.
\startformula
	F = \ddt p
		= \ddt (14\units{kg\.m/s^3})\,t^2
		= (14\units{kg\.m/s^3}) \ddt t^2
		= (28\units{kg\.m/s^3})\,t 
\stopformula
In the third expression, the derivative is acting on $(14\units{kg\.m/s^3})\,t^2$. We pull the constant $(14\units{kg\.m/s^3})$ out of the derivative to get the fourth expression, where the derivative is acting on $t^2$.  We then find $\ddt t^2$ using the power rule with $n=2$.

The fourth and final rule is for functions added together. The slope of the sum is equal to the sum of the slopes. For any two functions of time $f$ and $g$ we use the \keyterm{sum rule}.
\startformula
	\ddt (f+g) = \ddt f + \ddt g
\stopformula
For example, if an object's vertical position is given by the formula $y = (12\units{m/s})\,t - (4.9\units{m/s^2})\,t^2$, we can find the vertical component of its velocity.
\startformula\startmathalignment
\NC	v_y = \ddt y	
		\NC = \ddt \left[(12\units{m/s})\,t - (4.9\units{m/s^2})\,t^2\right]	\NR
\NC		\NC = \ddt (12\units{m/s})\,t - \ddt (4.9\units{m/s^2})\,t^2		\NR
\NC		\NC = (12\units{m/s})\ddt t - (4.9\units{m/s^2}) \ddt t^2			\NR
\NC		\NC = (12\units{m/s}) - (9.8\units{m/s^2})\,t						\NR
\stopmathalignment\stopformula
We used the sum rule, then the coefficient rule, and finally the power rule (twice) to find the velocity.

The derivative can be used on any coordinate ($y$, $z$, $\theta$) to find the corresponding component of the velocity ($v_y$, $v_z$, $\omega$). The derivative can also be used to find any component of force from the corresponding component of the momentum.

There are more derivative rules for more complicated functions, but the four rules above are all you need for this physics course. 

%We only need three rules for working with rates of change. In the rules below, $f$ and $g$ are functions of time, while $a$ and $n$ are constants.
%\startformula\startmathalignment
%\NC \ddt(af)	\NC = a \ddt f		\NR
%\NC \ddt (f + g)	\NC = \ddt f + \ddt  g	\NR
%\NC \ddt t^n	\NC = n t^{n-1}		\NR
%\stopmathalignment\stopformula
%
%
%There are two general derivative rules that we do not need: the product rule and the chain rule. These are both more difficult to understand and use than the rules above. We could use the product rule to get the power rule, but it that derivation probobaly doesn't bring much benefit.
%The chain rule is could be used for simple harmonic motion, $x = A \sin(t/2\pi T)$, but we don't need the instantaneous velocity of SHO at all times, just the maximum speed. There are, of course, many formulas for derivatives of specific functions (trig, exp, log, etc.), but I think we only need powers.

\startexample[ex:DerivativeConstantV]
An object's position $x$ at time $t$ is given by the equation
\startformula
	x = x_0 + v_0 t
\stopformula
Where $x_0$ and $v_0$ are constants. ($x_0$ is the object's starting position). Use the derivative rules to find the object's velocity $v$ at any time $t$.

\startsolution
We start with the instantaneous velocity definition $v=\frac{d}{dt}x$, and apply the rules.
\startformula\startmathalignment
\NC v = \ddt x
		\NC = \ddt (x_0 + v_0t)		\NR
\NC		\NC = \ddt x_0 + \ddt v_0t	\NR
\NC		\NC = 0 + v_0\ddt t			\NR
\NC		\NC = v_0					\NR
\stopmathalignment\stopformula
At any time $t$, the instantaneous velocity $v$ is the constant $v_0$. This is constant velocity motion, also call uniform motion.
\stopsolution
\stopexample


\startexample[ex:DerivativeConstantF]
An object's momentum $p$ at time $t$ is
\startformula
	p = p_0 + F_0t.
\stopformula
Where $p_0$ and $F_0$ are constants. ($p_0$ is the object's starting momentum). Find the force $F$ acting on the object at any time $t$.

\startsolution
Force is the rate of momentum change: $F=\frac{d}{dt}p$.
\startformula
	F = \ddt p = \ddt (p_0 + F_0 t) = F_0
\stopformula
The force $F$ is the constant $F_0$. This is constant force motion.
\stopsolution
\stopexample


\startexample[ex:DerivativeConstantF]
An object's position $x$ at time $t$ is given by the equation
\startformula
	x = x_0 + v_0 t + \half a_0 t^2
\stopformula
Where $x_0$ and $v_0$ and $a_0$ are constants. Find the object's velocity $v$ and the force acting on the object at any time $t$.
\startsolution
We start with the instantaneous velocity definition $v=\ddt x$, and apply the rules. Notice what happens to the \onehalf\ in the final term.
\startformula\startmathalignment
\NC v = \ddt x
		\NC = \ddt (x_0 + v_0t + \half a_0 t^2)		\NR
\NC		\NC = \ddt x_0 + \ddt v_0t  + \half a_0 t^2	\NR
\NC		\NC = 0 + v_0\ddt t	 + \half a_0 \ddt t^2	\NR
%\NC		\NC = v_0 + \half a 2 t				\NR
\NC		\NC = v_0 + a_0t							\NR
\stopmathalignment\stopformula
This velocity is not constant – the object is accelerating. (The object's initial velocity is $v_0$.) The momentum is also changing.
\startformula 
	p = mv = m(v_0 + a_0 t)
\stopformula	
Using the derivative rules we find the force $F$ acting on the object at any time $t$.
\startformula
	F = \ddt p = \ddt m(v_0 + a_0t) = m\ddt (v_0 + a_0t) = ma_0
\stopformula
At any time $t$, the force $F$ is 
\startformula
	F = ma_0
\stopformula
Since $m$ and $a_0$ are constants, this is constant force motion. The constant force $F$ acting on the object causes the object's constant acceleration $a_0$.
\stopsolution
\stopexample

%\section{Other problem ideas}
%Resistance forces are often proportional to velocity, resulting in function with negative powers. Find the force acting on an objects whose velocity is $v = c/t$. Find the force acting on an object whose position is $x = x_0 - c/t$ (The object approaches $x_0$, but never quite reaches it due to the slowing.)
%
%All of this works with any coordinates, so it would be good to have examples with $y$ and $\theta$ as functions of $t$. Several coordinates can be part of the same problem, giving velocity and force components, as well as angular velocity and torque.
%
%I considered problems using $F = \frac{d}{dx}H$, but these did not seem to provide a useful bridge from time derivatives to the partial derivatives below. In fact, it seems to blur the distinction in counter productive ways.

%\section{Local slopes are partial derivatives}
%
%Finding a pendulum's equations of motion symbolically requires the derivative of the potential energy $U = -mgR\cos(\theta)$. We don’t need chain rule in that case, but we do need $\frac{d}{d\theta}\cos(\theta) = -\sin(\theta)$. However, this problem is easy to solve with a diagram, which is probably better than doing it symbolically anyway.


\stoptext
\stopcomponent